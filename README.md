# ‚òÅÔ∏è Spring Cloud



![java](https://img.shields.io/badge/java-8-brightgreen)![maven](https://img.shields.io/badge/maven-3.6.3-brightgreen)![mysql](https://img.shields.io/badge/mysql-8.0.20-brightgreen)![spring boot](https://img.shields.io/badge/spring%20boot-2.2.2-brightgreen)![spring cloud](https://img.shields.io/badge/spring%20cloud-Hoxton.SR1-brightgreen)![spring cloud alibaba](https://img.shields.io/badge/spring%20cloud%20alibaba-2.1.0-brightgreen)![fastjson](https://img.shields.io/badge/fastjson-1.2.3-brightgreen)



## üí¨ ÂæÆÊúçÂä°Â∫èË®Ä



### üöÄ ÂæÆÊúçÂä°Êû∂ÊûÑÊ¶ÇËø∞



‚Äã		ÂæÆÊúçÂä°Êû∂ÊûÑÊó∂‰∏ÄÁßçÊû∂ÊûÑÊ®°ÂºèÔºåÂÆÉÊèêÂÄ°Â∞ÜÂçï‰∏ÄÂ∫îÁî®Á®ãÂ∫èÂàíÂàÜÊàê‰∏ÄÁªÑÂ∞èÁöÑÊúçÂä°ÔºåÊúçÂä°‰πãÈó¥‰∫íÁõ∏ÂçèË∞É„ÄÅ‰∫íÁõ∏ÈÖçÂêàÔºå‰∏∫ÂìüËøáÊà∑Êèê‰æõÊúÄÁªà‰ª∑ÂÄº„ÄÇÊØè‰∏™ÊúçÂä°ËøêË°åÂú®ÂÖ∂Áã¨Á´ãÁöÑËøõÁ®ã‰∏≠ÔºåÊúçÂä°‰∏éÊúçÂä°Èó¥ÈááÁî®ËΩªÈáèÁ∫ßÁöÑÈÄö‰ø°Êú∫Âà∂‰∫íÁõ∏Âçè‰ΩúÔºàÈÄöÂ∏∏ÊòØÂü∫‰∫éHTTPÂçèËÆÆÁöÑRestful APIÔºâ„ÄÇÊØè‰∏™ÊúçÂä°ÈÉΩÂõ¥ÁªïÁùÄÂÖ∑‰Ωì‰∏öÂä°ËøõË°åÊûÑÂª∫ÔºåÂπ∂‰∏îËÉΩÂ§üÂà´Áã¨Á´ãÁöÑÈÉ®ÁΩ≤Âà∞Áîü‰∫ßÁéØÂ¢É„ÄÅÁ±ªÁîü‰∫ßÁéØÂ¢ÉÁ≠â„ÄÇÂè¶Â§ñÔºåÂ∫îËØ•Â∞ΩÈáèÈÅøÂÖçÂêå‰∏ÄÁöÑ„ÄÅÈõÜ‰∏≠ÂºèÁöÑÊúçÂä°ÁÆ°ÁêÜÊú∫Âà∂ÔºåÂØπÂÖ∑‰ΩìÁöÑ‰∏Ä‰∏™ÊúçÂä°ËÄåË®ÄÔºåÂ∫îÊ†πÊçÆ‰∏öÂä°‰∏ä‰∏ãÊñáÔºåÈÄâÊã©ÂêàÈÄÇÁöÑËØ≠Ë®Ä„ÄÅÂ∑•ÂÖ∑ËøõË°åÊûÑÂª∫„ÄÇ



###  üìñ Spring CloudÁÆÄ‰ªã

Spring Cloud = ÂàÜÂ∏ÉÂºèÂæÆÊúçÂä°Êû∂ÊûÑÁöÑ‰∏ÄÁ´ôÂºèËß£ÂÜ≥ÊñπÊ°à„ÄÇ



> ÂàÜÂ∏ÉÂºèÂæÆÊúçÂä°

- ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞
- ÊúçÂä°Ë∞ÉÁî®
- ÊúçÂä°ÁÜîÊñ≠
- Ë¥üËΩΩÂùáË°°
- ÊúçÂä°ÈôçÁ∫ß
- ÊúçÂä°Ê∂àÊÅØÈòüÂàó
- ÈÖçÁΩÆ‰∏≠ÂøÉÁÆ°ÁêÜ
- ÊúçÂä°ÁΩëÂÖ≥
- ÊúçÂä°ÁõëÊéß
- ÂÖ®ÈìæË∑ØËøΩË∏™
- Ëá™Âä®ÂåñÊûÑÂª∫ÈÉ®ÁΩ≤
- ÊúçÂä°ÂÆöÊó∂‰ªªÂä°Ë∞ÉÂ∫¶Êìç‰Ωú

![image-20201125150829563](SpringCloud/image-20201125150829563.png)



> CloudÂçáÁ∫ß

![CloudUpgrade](SpringCloud/CloudUpgrade.jpg)



### üè≥Ô∏è‚Äçüåà ÁâàÊú¨ÈÄâÂûã



> ÂÆòÁΩëÈôêÂÆöÔºöhttps://spring.io/projects/spring-cloud

Êà™Ê≠¢ 2020-11-25

| Spring Cloud Version                                         | Spring Boot Version              |
| :----------------------------------------------------------- | :------------------------------- |
| 2020.0.x aka Ilford                                          | 2.4.x                            |
| [Hoxton](https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Hoxton-Release-Notes) | 2.2.x, 2.3.x (Starting with SR5) |
| [Greenwich](https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Greenwich-Release-Notes) | 2.1.x                            |
| [Finchley](https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Finchley-Release-Notes) | 2.0.x                            |
| [Edgware](https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Edgware-Release-Notes) | 1.5.x                            |
| [Dalston](https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Dalston-Release-Notes) | 1.5.x                            |



> ÂÖ∑‰ΩìÈôêÂÆöÔºöhttps://start.spring.io/actuator/info

Êà™Ê≠¢ 2020-11-25

```json

    "spring-cloud": {
      "Finchley.M2": "Spring Boot >=2.0.0.M3 and <2.0.0.M5",
      "Finchley.M3": "Spring Boot >=2.0.0.M5 and <=2.0.0.M5",
      "Finchley.M4": "Spring Boot >=2.0.0.M6 and <=2.0.0.M6",
      "Finchley.M5": "Spring Boot >=2.0.0.M7 and <=2.0.0.M7",
      "Finchley.M6": "Spring Boot >=2.0.0.RC1 and <=2.0.0.RC1",
      "Finchley.M7": "Spring Boot >=2.0.0.RC2 and <=2.0.0.RC2",
      "Finchley.M9": "Spring Boot >=2.0.0.RELEASE and <=2.0.0.RELEASE",
      "Finchley.RC1": "Spring Boot >=2.0.1.RELEASE and <2.0.2.RELEASE",
      "Finchley.RC2": "Spring Boot >=2.0.2.RELEASE and <2.0.3.RELEASE",
      "Finchley.SR4": "Spring Boot >=2.0.3.RELEASE and <2.0.999.BUILD-SNAPSHOT",
      "Finchley.BUILD-SNAPSHOT": "Spring Boot >=2.0.999.BUILD-SNAPSHOT and <2.1.0.M3",
      "Greenwich.M1": "Spring Boot >=2.1.0.M3 and <2.1.0.RELEASE",
      "Greenwich.SR6": "Spring Boot >=2.1.0.RELEASE and <2.1.999.BUILD-SNAPSHOT",
      "Greenwich.BUILD-SNAPSHOT": "Spring Boot >=2.1.999.BUILD-SNAPSHOT and <2.2.0.M4",
      "Hoxton.SR9": "Spring Boot >=2.2.0.M4 and <2.3.7.BUILD-SNAPSHOT",
      "Hoxton.BUILD-SNAPSHOT": "Spring Boot >=2.3.7.BUILD-SNAPSHOT and <2.4.0.M1",
      "2020.0.0-M3": "Spring Boot >=2.4.0.M1 and <=2.4.0.M1",
      "2020.0.0-M4": "Spring Boot >=2.4.0.M2 and <=2.4.0-M3",
      "2020.0.0-M5": "Spring Boot >=2.4.0.M4 and <2.4.1-SNAPSHOT",
      "2020.0.0-SNAPSHOT": "Spring Boot >=2.4.1-SNAPSHOT"
    },
    "spring-cloud-alibaba": {
      "2.2.1.RELEASE": "Spring Boot >=2.2.0.RELEASE and <2.3.0.M1"
    },
```



> ÊäÄÊúØÈÄâÂûã

![VersionSelect](SpringCloud/VersionSelect.jpg)



```xml
<?xml version="1.0" encoding="UTF-8"?>

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>top.parak.springcloud</groupId>
  <artifactId>cloud2020</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>pom</packaging>

  <developers>
    <developer>
      <name>KHighness</name>
      <email>parakovo@gmail.com</email>
    </developer>
  </developers>

  <modules>
  </modules>

  <!-- Jar Version Management-->
  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
    <java.version>1.8</java.version>
    <junit.version>4.12</junit.version>
    <log4j.version>1.2.17</log4j.version>
    <lombok.version>1.18.16</lombok.version>
    <mysql.version>8.0.20</mysql.version>
    <fastjson.version>1.2.75</fastjson.version>
    <druid.version>1.2.3</druid.version>
    <spring.boot.version>2.2.2.RELEASE</spring.boot.version>
    <spring.cloud.version>Hoxton.SR1</spring.cloud.version>
    <spring.cloud.alibaba.version>2.1.0.RELEASE</spring.cloud.alibaba.version>
    <druid.spring.boot.starter.version>1.2.3</druid.spring.boot.starter.version>
    <mybatis.spring.boot.starter.version>2.1.1</mybatis.spring.boot.starter.version>
    <mybatis-plus.boot.starter.version>3.4.1</mybatis-plus.boot.starter.version>
    <hutool-all.version>5.5.1</hutool-all.version>
  </properties>

  <dependencyManagement>
    <dependencies>

      <!-- Spring Boot -->
      <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-dependencies</artifactId>
        <version>${spring.boot.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>

      <!-- Spring Cloud -->
      <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-dependencies</artifactId>
        <version>${spring.cloud.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>

      <!-- Spring Cloud alibaba -->
      <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-alibaba-dependencies</artifactId>
        <version>${spring.cloud.alibaba.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>

      <!-- Mysql -->
      <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>${mysql.version}</version>
        <scope>runtime</scope>
      </dependency>

      <!-- Druid-->
      <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>druid</artifactId>
        <version>${druid.version}</version>
      </dependency>

      <!-- Mybatis Starter -->
      <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
        <version>${mybatis.spring.boot.starter.version}</version>
      </dependency>

      <!-- Druid Starter -->
      <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>druid-spring-boot-starter</artifactId>
        <version>${druid.spring.boot.starter.version}</version>
      </dependency>

      <!-- Junit -->
      <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>${junit.version}</version>
        <scope>test</scope>
      </dependency>

      <!-- Lombok -->
      <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <version>${lombok.version}</version>
        <scope>provided</scope>
      </dependency>

      <!-- Fastjson -->
      <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>fastjson</artifactId>
        <version>${fastjson.version}</version>
      </dependency>

    </dependencies>
  </dependencyManagement>

  <build>
    <plugins>
      <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
        <configuration>
          <fork>true</fork>
          <addResources>true</addResources>
        </configuration>
      </plugin>
    </plugins>
  </build>

</project>
```



## üí† ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉ



### üå† Eureka



> Ê¶ÇËø∞

Github: https://github.com/Netflix/Eureka

Spring Cloud Eureka ÊòØ Spring Cloud Netflix ÂæÆÊúçÂä°Â•ó‰ª∂ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂü∫‰∫é Netflix Eureka ÂÅö‰∫Ü‰∫åÊ¨°Â∞ÅË£ÖÔºå‰∏ªË¶ÅË¥üË¥£ÂÆûÁé∞ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÁöÑÊúçÂä°Ê≤ªÁêÜÂäüËÉΩ„ÄÇSpring Cloud Eureka ÊòØ‰∏Ä‰∏™Âü∫‰∫é REST ÁöÑÊúçÂä°ÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜÂü∫‰∫éJavaÁöÑÂÆ¢Êà∑Á´ØÁªÑ‰ª∂ÔºåËÉΩÂ§üÈùûÂ∏∏Êñπ‰æøÂú∞Â∞ÜÊúçÂä°Ê≥®ÂÜåÂà∞ Spring Cloud Eureka ‰∏≠ËøõË°åÁªü‰∏ÄÁÆ°ÁêÜ„ÄÇ



> ÊúçÂä°Ê≤ªÁêÜ

Âú®‰º†ÁªüÁöÑRPCËøúÁ®ãË∞ÉÁî®Ê°ÜÊû∂‰∏≠ÔºåÁÆ°ÁêÜÊØè‰∏™ÊúçÂä°‰∫éÊúçÂä°‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÊØîËæÉÂ§çÊùÇÔºåÊâÄ‰ª•ÈúÄË¶Å‰ΩøÁî®ÊúçÂä°Ê≤ªÁêÜÔºåÁÆ°ÁêÜÊúçÂä°‰∏éÊúçÂä°‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÔºåÂèØ‰ª•ÂÆûÁé∞ÊúçÂä°Ë∞ÉÁî®„ÄÅË¥üËΩΩÂùáË°°„ÄÅÂÆπÈîôÁ≠âÔºåÂÆûÁé∞ÊúçÂä°ÂèëÁé∞‰∏éÊ≥®ÂÜå„ÄÇ



> ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞

EurekaÈááÁî®‰∫ÜCSÁöÑËÆæËÆ°Êû∂ÊûÑÔºåEureka Server‰Ωú‰∏∫ÊúçÂä°Ê≥®ÂÜåÂäüËÉΩÁöÑÊúçÂä°Âô®ÔºåÂÆÉÊòØÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÔºåËÄåÁ≥ªÁªü‰∏≠ÁöÑÂÖ∂‰ªñÂæÆÊúçÂä°Ôºå‰ΩøÁî®EurekaÁöÑÂÆ¢Êà∑Á´ØËøûÊé•Âà∞Eureka ServerÂπ∂Áª¥ÊåÅÂøÉË∑≥ËøûÊé•„ÄÇËøôÊ†∑Á≥ªÁªüÁöÑÁª¥Êä§‰∫∫ÂëòÂ∞±ÂèØ‰ª•ÈÄöËøáEureka ServerÊù•ÁõëÊéßÁ≥ªÁªü‰∏≠ÂêÑ‰∏™ÂæÆÊúçÂä°ÊòØÂê¶Ê≠£Â∏∏ËøêË°å„ÄÇ

Âú®ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞‰∏≠ÂøÉÔºåÊúâ‰∏Ä‰∏™Ê≥®ÂÜå‰∏≠ÂøÉÔºåÂΩìÊúçÂä°Âô®ÂêØÂä®ÁöÑÊó∂ÂÄôÔºå‰ºöÊääËá™Â∑±ÊúçÂä°Âô®ÁöÑ‰ø°ÊÅØÊØîÂ¶ÇÊúçÂä°Âú∞ÂùÄ„ÄÅÈÄöËÆØÂú∞ÂùÄÁ≠â‰ª•Âà´ÂêçÊñπÂºèÊ≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ‰∏ä„ÄÇÂè¶‰∏ÄÊñπÔºàÊ∂àË¥πËÄÖ|ÊúçÂä°Êèê‰æõËÄÖÔºâÔºå‰ª•ËØ•Âà´ÂêçÁöÑÊñπÂºèÂéªÊ≥®ÂÜå‰∏≠ÂøÉ‰∏äËé∑ÂèñÂà∞ÂÆûÈôÖÁöÑÊúçÂä°ÈÄöËÆØÂú∞ÂùÄÔºåÁÑ∂ÂêéÂÜçÂÆûÁé∞Êú¨Âú∞RPCË∞ÉÁî®RPCËøúÁ®ãË∞ÉÁî®Ê°ÜÊû∂Ê†∏ÂøÉËÆæËÆ°ÊÄùÊÉ≥ÔºöÂú®‰∫éÊ≥®ÂÜå‰∏≠ÂøÉÔºåÂõ†‰∏∫‰ΩøÁî®Ê≥®ÂÜå‰∏≠ÂøÉÁÆ°ÁêÜÊØè‰∏™ÊúçÂä°‰∫éÊúçÂä°‰πãÈó¥ÁöÑ‰∏Ä‰∏™‰æùËµñÂÖ≥Á≥ªÔºàÊúçÂä°Ê≤ªÁêÜÊ¶ÇÂøµÔºâ„ÄÇÂú®‰ªª‰ΩïRPCËøúÁ®ãÊ°ÜÊû∂‰∏≠ÔºåÈÉΩ‰ºöÊúâ‰∏Ä‰∏™Ê≥®ÂÜå‰∏≠ÂøÉÔºàÂ≠òÊîæÊúçÂä°Âú∞ÂùÄÁõ∏ÂÖ≥‰ø°ÊÅØÔºàÊé•Âè£Âú∞ÂùÄÔºâÔºâ„ÄÇ



> EurekaÁªÑ‰ª∂ÔºöEureka ServerÂíåEureka Client

1Ô∏è‚É£ Eureka ServerÊèê‰æõÊúçÂä°Ê≥®ÂÜåÊúçÂä°

ÂêÑ‰∏™ÂæÆÊúçÂä°ËäÇÁÇπÈÄöËøáÈÖçÁΩÆÂêØÂä®ÂêéÔºå‰ºöÂú®Eureka Server‰∏≠ËøõË°åÊ≥®ÂÜåÔºåËøôÊ†∑Eureka Server‰∏≠ÁöÑÊúçÂä°Ê≥®ÂÜåË°®Â∞Ü‰ºöÂ≠òÂÇ®ÊâÄÊúâÂèØÁî®ÊúçÂä°ËäÇÁÇπÁöÑ‰ø°ÊÅØÔºåÊúçÂä°ËäÇÁÇπÁöÑ‰ø°ÊÅØÂèØ‰ª•Âú®ÁïåÈù¢‰∏≠Áõ¥ËßÇÁúãÂà∞„ÄÇ

2Ô∏è‚É£ Eureka ClientÈÄöËøáÊ≥®ÂÜå‰∏≠ÂøÉËøõË°åËÆøÈóÆ

ÊòØ‰∏Ä‰∏™JavaÂÆ¢Êà∑Á´ØÔºåÁî®‰∫éÁÆÄÂåñEureka SeverÁöÑ‰∫§‰∫íÔºåÂÆ¢Êà∑Á´ØÂêåÊó∂‰πüÂÖ∑Â§á‰∏Ä‰∏™ÂÜÖÁΩÆÁöÑ„ÄÅ‰ΩøÁî®ËΩÆËØ¢Ë¥üËΩΩÁÆóÊ≥ïÁöÑË¥üËΩΩÂùáË°°Âô®„ÄÇÂú®Â∫îÁî®ÂêØÂä®ÂêéÔºåÂ∞Ü‰ºöÂú®Eureka ServerÂèëÈÄÅÂøÉË∑≥(ÈªòËÆ§Âë®Êúü‰∏∫30S)„ÄÇÂ¶ÇÊûúEureka ServerÂú®Â§ö‰∏™ÂøÉË∑≥Âë®ÊúüÂÜÖÊ≤°ÊúâÊé•Êî∂Âà∞Êüê‰∏™ËäÇÁÇπÁöÑÂøÉË∑≥ÔºåEureka ServerÂ∞Ü‰ºö‰ªéÊúçÂä°Ê≥®ÂÜåË°®‰∏≠ÊääËøô‰∏™ÊúçÂä°ËäÇÁÇπÁßªÈô§„ÄÇ



> EurekaÁöÑËá™Êàë‰øùÊä§Ê®°Âºè

1Ô∏è‚É£Ê¶ÇËø∞

ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúEureka ServerÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÊ≤°ÊúâÊé•Êî∂Âà∞Êüê‰∏™ÂæÆÊúçÂä°ÂÆû‰æãÁöÑÂøÉË∑≥ÔºåEureka ServerÂ∞Ü‰ºöÊ≥®ÈîÄËØ•ÂÆû‰æãÔºàÈªòËÆ§90ÁßíÔºâ„ÄÇ‰ΩÜÊòØÂΩìÂâçÁΩëÁªúÂàÜÂå∫ÊïÖÈöúÂèëÁîüÔºàÂª∂Êó∂„ÄÅÂç°È°ø„ÄÅÊã•Êå§ÔºâÊó∂ÔºåÂæÆÊúçÂä°‰∏éEureka Server‰πãÈó¥Êó†Ê≥ïÊ≠£Â∏∏ÈÄö‰ø°Ôºå‰ª•‰∏äË°å‰∏∫‰ºöÂèòÂæóÂç±Èô©‚Äî‚ÄîÂõ†‰∏∫ÂæÆÊúçÂä°Êú¨Ë∫´ÊòØÂÅ•Â∫∑ÁöÑÔºåÊ≠§Êó∂Êú¨‰∏çÂ∫îËØ•Ê≥®ÈîÄËøô‰∏™ÂæÆÊúçÂä°„ÄÇEurekaÈÄöËøá‚ÄúËá™Êàë‰øùÊä§Ê®°Âºè‚ÄùÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò‚Äî‚Äî‚Äî‚ÄîÂΩìEurekaËäÇÁÇπÂú®Áü≠Êó∂Èó¥ÂÜÖ‰∏¢Â§±ËøáÂ§öÂÆ¢Êà∑Á´ØÊó∂ÂÄôÔºåÈÇ£‰πàËøô‰∏™ËäÇÁÇπÂ∞±ËøõÂÖ•Ëá™Êàë‰øùÊä§Ê®°Âºè„ÄÇ

2Ô∏è‚É£Áî®ÈÄî

‰øùÊä§Ê®°Âºè‰∏ªË¶ÅÁî®‰∫é‰∏ÄÁªÑEureka ClientÂíåEureka Server‰πãÈó¥Â≠òÂú®ÁΩëÁªúÂàÜÂå∫Âú∫ÊôØ‰∏ãÁöÑ‰øùÊä§„ÄÇ‰∏ÄÊó¶ËøõÂÖ•‰øùÊä§Ê®°ÂºèÔºåEureka ServerÂ∞Ü‰ºöÂ∞ùËØï‰øùÊä§ÂÖ∂ÂæÆÊúçÂä°Ê≥®ÂÜåË°®‰∏≠ÁöÑ‰ø°ÊÅØÔºå‰∏çÂÜçÂà†Èô§ÊúçÂä°Ê≥®ÂÜåË°®‰∏≠ÁöÑÊï∞ÊçÆÔºå‰πüÂ∞±ÊòØ‰∏ç‰ºöÊ≥®ÈîÄ‰ªª‰ΩïÂæÆÊúçÂä°„ÄÇ‰ΩøÁî®Ëá™Êàë‰øùÊä§Ê®°ÂºèÔºåÂèØ‰ª•ËÆ©EurekaÈõÜÁæ§Êõ¥Âä†ÁöÑÂÅ•Â£Æ„ÄÅÁ®≥ÂÆö„ÄÇ

3Ô∏è‚É£ËÆæËÆ°Âì≤Â≠¶

ÂÆÅÂèØ‰øùÊä§ÈîôËØØÁöÑÊúçÂä°Ê≥®ÂÜå‰ø°ÊÅØÔºå‰πü‰∏çÁõ≤ÁõÆÊ≥®ÈîÄ‰ªª‰ΩïÂèØËÉΩÂÅ•Â∫∑ÁöÑÊúçÂä°ÂÆû‰æã„ÄÇ

4Ô∏è‚É£ÂÖ≥Èó≠Ëá™Êàë‰øùÊä§Ê®°Âºè

EurekaÁöÑËá™Êàë‰øùÊä§Ê®°ÂºèÈªòËÆ§ÊòØÂºÄÂêØÁöÑÔºåÂÖ≥Èó≠ÈúÄË¶ÅÈÖçÁΩÆEureka ServerÔºö

```yml
eureka:
  server:
    # ÂÖ≥Èó≠Ëá™Êàë‰øùÊä§Ê®°ÂºèÔºåÂØπÊ≤°ÊúâÂøÉË∑≥ÁöÑÂæÆÊúçÂä°Áõ¥Êé•ÊùÄÊó†Ëµ¶Ôºå‰øùËØÅ‰∏çÂèØÁî®ÊúçÂä°ÂèäÊó∂Ë∏¢Èô§
    enable-self-preservation: false 
    # Ê∏ÖÁêÜÊó†ÊïàËäÇÁÇπÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ÊòØ60000ms
    eviction-interval-timer-in-ms: 2000
```

ÈáçÂêØEureka ServerËøõÂÖ•EurekaÂèØËßÜÂåñÔºåÂèØ‰ª•ÁúãÂà∞ËøôÂè•ËØùÔºö

```plaintext
THE SELF PRESERVATION MODE IS TURNED OFF. THIS MAY NOT PROTECT INSTANCE EXPIRY IN CASE OF NETWORK/OTHER PROBLEMS.
```

ÈÖçÁΩÆEureka Client

```properties
eureka:
  instance:
    # Eureka ClientÂêëEureka ServerÂèëÈÄÅÂøÉË∑≥ÁöÑÊó∂Èó¥Èó¥Èöî/È¢ëÁéáÔºåÂçï‰Ωç‰∏∫Áßí(ÈªòËÆ§ÊòØ30S)
    # Âú®Ëøô‰∏™Êó∂Èó¥Èó¥ÈöîÂêéÔºåEureka ServerÊ≤°ÊúâÊî∂Âà∞Eureka clientÁöÑÂøÉË∑≥ÔºåÂ∞ÜÂâîÈô§ÊúçÂä°
    lease-renewal-interval-in-seconds: 1
    # Eureka ServerÂú®Êî∂Âà∞ÊúÄÂêé‰∏ÄÊ¨°ÂøÉË∑≥ÂêéÁ≠âÂæÖÊó∂Èó¥‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Áßí(ÈªòËÆ§ÊòØ90S)
    # Ë∂ÖÊó∂Â∞ÜÂâîÈô§ÊúçÂä°
    lease-expiration-duration-in-seconds: 2
```

ÂºÄÂêØÂæÆÊúçÂä°Âπ∂‰∏îÂæàÂø´ÂÅúÊ≠¢ÔºåÂèØ‰ª•ÁúãÂà∞Eureka ServerÁöÑÊó•Âøó‰∏ä1sËøáÊúü‰∫Ü‰∏Ä‰∏™ÊúçÂä°ÔºåEurekaÂèØËßÜÂåñ‰∏äÊ≥®ÂÜåÁöÑÊúçÂä°Áõ¥Êé•Ê∂àÂ§±



> EurekaÂÅúÊõ¥ËØ¥Êòé

Eureka 2.xÂÅúÊ≠¢Êõ¥Êñ∞ÔºåEureka 1.x Âú®ÂºÄÊ∫êÁ§æÂå∫‰æùÁÑ∂Ê¥ªË∑É„ÄÇ

[eureka-wiki](https://github.com/Netflix/eureka/wiki)

The existing open source work on eureka 2.0 is discontinued. The code base and artifacts that were released as part of the existing repository of work on the 2.x branch is considered use at your own risk.

Eureka 1.x is a core part of Netflix's service discovery system and is still an active project.



### üí§ ZooKeeper



> Ê¶ÇËø∞

ÂÆòÁΩë: [apache-zookeeper](https://zookeeper.apache.org/)

wikiÊñáÊ°£: [wiki-zookeeper](https://cwiki.apache.org/confluence/display/ZOOKEEPER/Index)

ZooKeeperÊòØÁî®‰∫éÁª¥Êä§ÈÖçÁΩÆ‰ø°ÊÅØÔºåÂëΩÂêçÔºåÊèê‰æõÂàÜÂ∏ÉÂºèÂêåÊ≠•‰ª•ÂèäÊèê‰æõÁªÑÊúçÂä°ÁöÑÈõÜ‰∏≠ÂºèÊúçÂä°„ÄÇ



> DockerËøêË°åZookeeper

```shell
$ docker pull zookeeper
$ docker run -d -it -p 2181:2181 --name=zoo zookeeper
```



> POM

```xml
<dependencies>
    <!-- SpringBootÊï¥ÂêàZookeeperÂÆ¢Êà∑Á´Ø -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-zookeeper-discovery</artifactId>
        <exclusions>
            <!-- ÊéíÈô§Ëá™Â∏¶ÁöÑzookeeper3.5.3 -->
            <exclusion>
                <groupId>org.apache.zookeeper</groupId>
                <artifactId>zookeeper</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <!-- Ê∑ªÂä†zookeeper3.4.14 -->
    <dependency>
        <groupId>org.apache.zookeeper</groupId>
        <artifactId>zookeeper</artifactId>
        <version>3.4.14</version>
        <!-- ÊéíÈô§Ëá™Â∏¶ÁöÑSlf4j -->
        <exclusions>
            <exclusion>
                <artifactId>slf4j-log4j12</artifactId>
                <groupId>org.slf4j</groupId>
            </exclusion>
        </exclusions>
    </dependency>
</dependencies>
```



### üí´ Consul



> Ê¶ÇËø∞

ÂÆòÁΩëÔºö[Consul](https://www.consul.io/docs/intro)

ÂÖ•Èó®ÊñáÊ°£Ôºö[spring-cloud-consul](https://www.springcloud.cc/spring-cloud-consul.html)

Consul(GoËØ≠Ë®ÄÂºÄÂèë)ÊòØ‰∏ÄÁßçÊúçÂä°ÁΩëÊ†ºËß£ÂÜ≥ÊñπÊ°àÔºåÊèê‰æõÂÖ∑ÊúâÊúçÂä°ÂèëÁé∞ÔºåÈÖçÁΩÆÂíåÂàÜÊÆµÂäüËÉΩÁöÑÂÖ®ÂäüËÉΩÊéßÂà∂Âπ≥Èù¢„ÄÇ



> DockerËøêË°åConsul

```shell
$ mkdir -p /home/consul/data /home/consul/conf
$ docker run -d --name=con -p 8500:8500  -v /home/consul/conf/:/consul/conf/                   -v /home/consul/data/:/consul/data/ consul
```

ConsulÊúâÂâçÁ´ØÂèØËßÜÂåñÁïåÈù¢ÔºåÊ≠§Êó∂ËæìÂÖ•ËôöÊãüÊú∫IP:8500Âç≥ÂèØËÆøÈóÆ„ÄÇ



> POM

```xml
<dependencies>
    <!-- SpringCloud Consul Server -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-consul-discovery</artifactId>
    </dependency>
</dependencies>
```





### üåÄ CAP



> CAPÂéüÂàô

Âú®‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠Ôºö

- C(Consistency): ‰∏ÄËá¥ÊÄß(All nodes see the same data at the same time)

- A(Availability): ÂèØÁî®ÊÄß(Reads and writes always succeed)

- P(Partition tolerance): ÂàÜÂå∫ÂÆπÈîôÊÄß(The system continues to operate despite arbitrary message loss or failure of part of the system)

‰ª•‰∏ä‰∏âÁÇπÂè™ËÉΩÊª°Ë∂≥‰ªªÊÑè‰∏§ÁÇπÔºå‰∏çÂèØËÉΩ‰∏âËÄÖÂÖºÈ°æ„ÄÇ



> ‰∏â‰∏™Ê≥®ÂÜå‰∏≠ÂøÉ

Áé∞Âú®ÁöÑÂàÜÂ∏ÉÂºèÂæÆÊúçÂä°Êû∂ÊûÑÈÉΩÂøÖÈ°ª‰øùËØÅPÂéüÂàô

|  ÁªÑ‰ª∂Âêç   | ËØ≠Ë®Ä | CAP  | ÊúçÂä°ÂÅ•Â∫∑Ê£ÄÊü• | ÂØπÂ§ñÊö¥Èú≤Êé•Âè£ | Spring CloudÈõÜÊàê |
| :-------: | :--: | :--: | :----------: | :----------: | :--------------: |
|  Eureka   | Java |  AP  |   ÂèØÈÖçÊîØÊåÅ   |     HTTP     |      Â∑≤ÈõÜÊàê      |
|  Consul   |  Go  |  CP  |     ÊîØÊåÅ     |   HTTP/DNS   |      Â∑≤ÈõÜÊàê      |
| Zookeeper | Java |  CP  |     ÊîØÊåÅ     |    ÂÆ¢Êà∑Á´Ø    |      Â∑≤ÈõÜÊàê      |





## üî± ÊúçÂä°Ë∞ÉÁî®



### üéóRibbon



> ËØ¥Êòé

wikiÊñáÊ°£Ôºö[wiki-ribbon](https://github.com/Netflix/ribbon/wiki)

Spring Cloud RibbonÊòØÂü∫‰∫éNetflixÁöÑÂºÄÊ∫êÈ°πÁõÆÔºå‰∏ªË¶ÅÂäüËÉΩÊòØÊèê‰æõÂÆ¢Êà∑Á´ØÁöÑËΩØ‰ª∂Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÂíåÊúçÂä°Ë∞ÉÁî®„ÄÇ

RibbonÂÆ¢Êà∑Á´ØÁªÑ‰ª∂Êèê‰æõ‰∏ÄÁ≥ªÂàóÂÆåÂñÑÁöÑÈÖçÁΩÆÈ°πÂ¶ÇËøûÊé•Ë∂ÖÊó∂„ÄÅÈáçËØïÁ≠â„ÄÇÁÆÄÂçïÁöÑËØ¥ÔºåÂ∞±ÊòØÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂàóÂá∫Load BalancerÔºàÁÆÄÁß∞LBÔºâÂêéÈù¢ÊâÄÊúâÁöÑÊú∫Âô®ÔºåRibbon‰ºöËá™Âä®ÁöÑÂ∏ÆÂä©‰Ω†Âü∫‰∫éÊüêÁßçËßÑÂàôÔºàÂ¶ÇÁÆÄÂçïËΩÆËØ¢ÔºåÈöèÊú∫ËøûÊé•Á≠âÔºâÂéªËøûÊé•Ëøô‰∫õÊú∫Âô®„ÄÇÊàë‰ª¨ÂæàÂÆπÊòì‰ΩøÁî®RibbonÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑË¥üËΩΩÂùáË°°ÁÆóÊ≥ï„ÄÇ



> LB

Load BalanceÔºåË¥üËΩΩÂùáË°°ÔºåÂ∞ÜÁî®Êà∑ËØ∑Ê±ÇÂπ≥ÊëäÂà∞Â§ö‰∏™ÊúçÂä°Âô®‰∏äÔºå‰ªéËÄåËææÂà∞Á≥ªÁªüÁöÑHAÔºàÈ´òÂèØÁî®Ôºâ„ÄÇ



> Ê†∏ÂøÉÁªÑ‰ª∂IRule

![image-20201218194608766](SpringCloud/image-20201218194608766.png)

1Ô∏è‚É£Ê†πÊçÆÁâπÂÆöÁÆóÊ≥ï‰ªéÊúçÂä°ÂàóË°®‰∏≠ÈÄâÂèñ‰∏Ä‰∏™Ë¶ÅËÆøÈóÆÁöÑÊúçÂä°Ôºö

- RoundRobinRule: ËΩÆËØ¢(ÈªòËÆ§)
- RandomRule: ÈöèÊú∫
- RetryRule: ÂÖàÊåâÁÖßRoundRuleÁöÑÁ≠ñÁï•Ëé∑ÂèñÊúçÂä°ÔºåÂ¶ÇÊûúÊúçÂä°Â§±Ë¥•ÂàôÂú®ÊåáÂÆöÊó∂Èó¥ÂÜÖËøõË°åÈáçËØïÔºåËé∑ÂèñÂèØÁî®ÁöÑÊúçÂä°
- WeightedResponseTimeRule: ÂØπRoundRobinRuleÁöÑÊâ©Â±ïÔºåÂìçÂ∫îÈÄüÂ∫¶Ë∂äÂø´ÁöÑÂÆû‰æãÈÄâÊã©ÊùÉÈáçË∂äÂ§ßÔºåË∂äÂÆπÊòìË¢´ÈÄâÊã©
- BestAvaiableRule: ‰ºöÂÖàËøáÊª§ÊéâÁî±‰∫éÂ§öÊ¨°ËÆøÈóÆÊïÖÈöúËÄåÂ§Ñ‰∫éÊñ≠Ë∑ØÂô®Ë∑≥Èó∏Áä∂ÊÄÅÁöÑÊúçÂä°ÔºåÁÑ∂ÂêéÈÄâÊã©‰∏Ä‰∏™Âπ∂ÂèëÈáèÂ∞èÁöÑÊúçÂä°
- AvailabilityFilteringRule: ÂÖàËøáÊª§ÊéâÊïÖÈöúÂÆû‰æãÔºåÂÜçÈÄâÊã©Âπ∂ÂèëËæÉÂ∞èÁöÑÂÆû‰æã
- ZoneAvoidanceRule: ÈªòËÆ§ËßÑÂàôÔºåÂ§çÂêàÂà§Êñ≠serverÊâÄÂú®Âå∫ÂüüÁöÑÊÄßËÉΩÂíåserverÁöÑÂèØÁî®ÊÄßÈÄâÊã©ÊúçÂä°Âô®

2Ô∏è‚É£Ëá™ÂÆö‰πâÁÆóÊ≥ïÁöÑËßÑÂàôÔºàÂÆòÊñπÊñáÊ°£Ë≠¶ÂëäÔºâÔºö

Ëá™ÂÆö‰πâÈÖçÁΩÆÁ±ª‰∏çËÉΩÊîæÂú®@ComponentScanÊâÄÊâ´ÊèèÁöÑÂΩìÂâçÂåÖ‰ª•ÂèäÂ≠êÂåÖ‰∏ãÔºåÂê¶ÂàôËá™ÂÆö‰πâÁöÑËøô‰∏™ÈÖçÁΩÆÁ±ªÂ∞±‰ºöË¢´ÊâÄÊúâÁöÑRibbonÂÆ¢Êà∑Á´ØÂÖ±‰∫´ÔºåËææ‰∏çÂà∞ÁâπÊÆäÂÆöÂà∂ÂåñÁöÑÁõÆÁöÑ„ÄÇ

@SpringBootApplicationÂåÖÂê´‰∏âÂ§ßÊ≥®Ëß£Ôºö

- @SpringBootConfiguration

- @EnableAutoConfiguration
- @ComponentScan

Âõ†Ê≠§ÔºåËá™ÂÆö‰πâÈÖçÁΩÆÁ±ª‰∏çËÉΩ‰∏éSpringbootApplication‰∏ªÂêØÂä®Á±ªÊîæÂú®‰∏Ä‰∏™ÂåÖ‰∏ã„ÄÇ



### üõë OpenFeign



> Ê¶ÇËø∞

FeignÊòØ‰∏Ä‰∏™Â£∞ÊòéÂºèWebServiceÂÆ¢Êà∑Á´ØÔºå‰ΩøÁî®FeignËÉΩËÆ©ÁºñÂÜôWeb ServiceÂÆ¢Êà∑Á´ØÊõ¥Âä†ÁÆÄÂçï„ÄÇ‰ΩøÁî®ÊñπÊ≥ïÊó∂ÂÆö‰πâ‰∏Ä‰∏™ÊúçÂä°Êé•Âè£ÁÑ∂ÂêéÂú®‰∏äÈù¢Ê∑ªÂä†Ê≥®Ëß£„ÄÇFeign‰πüÊîØÊåÅÂèØÊãîÊèíÂºèÁöÑÁºñÁ†ÅÂô®ÂíåËß£Á†ÅÂô®„ÄÇSpring CloudÂØπFeignËøõË°å‰∫ÜÂ∞ÅË£ÖÔºå‰ΩøÂÖ∂ÊîØÊåÅ‰∫ÜSpring MVCÊ†áÂáÜÊ≥®Ëß£ÂíåHttpMessageConverters„ÄÇFeignÂèØ‰ª•‰∏éEurekaÂíåRibbonÁªÑÂêà‰ΩøÁî®‰ª•ÊîØÊåÅË¥üËΩΩÂùáË°°„ÄÇ

FeignÊó®Âú®‰ΩøÁºñÂÜôJava HttpÂÆ¢Êà∑Á´ØÂèòÂæóÊõ¥ÂÆπÊòì„ÄÇ

ÂâçÊúü‰ΩøÁî®Ribbon + RestTemplateÊó∂Ôºå‰ΩøÁî®RestTemplateÂØπhttpËØ∑Ê±ÇÁöÑÂ∞ÅË£ÖÂ§ÑÁêÜÔºåÂΩ¢Êàê‰∫Ü‰∏ÄÂ•óÊ®°ÊùøÂåñÁöÑË∞ÉÁî®ÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÂú®ÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåÁî±‰∫éÂØπÊúçÂä°‰æùËµñÁöÑË∞ÉÁî®ÂèØËÉΩ‰∏çÊ≠¢‰∏ÄÂ§ÑÔºåÂæÄÂæÄ‰∏Ä‰∏™Êé•Âè£‰ºöË¢´Â§öÂ§ÑË∞ÉÁî®ÔºåÊâÄ‰ª•ÈÄöÂ∏∏ÈÉΩ‰ºöÈíàÂØπÊØè‰∏™ÂæÆÊúçÂä°Ëá™Ë°åÂ∞ÅË£Ö‰∏Ä‰∫õÂÆ¢Êà∑Á´ØÁ±ªÊù•ÂåÖË£ÖËøô‰∫õ‰æùËµñÊúçÂä°ÁöÑË∞ÉÁî®„ÄÇÊâÄ‰ª•ÔºåFeignÂú®Ê≠§Âü∫Á°Ä‰∏äÊù•ÈÖçÁΩÆÂÆÉÔºà‰ª•ÂâçÊòØDaoÊé•Âè£‰∏äÊ†áÊ≥®‰∏Ä‰∏™FeignÊ≥®Ëß£Âç≥ÂèØÔºâÔºåÂç≥ÂèØÂÆåÊàêÂØπÊúçÂä°Êèê‰æõÊñπÁöÑÊé•Âè£ÁªëÂÆöÔºåÁÆÄÂåñ‰∫Ü‰ΩøÁî®Spring Cloud RibbonÊó∂ÔºåËá™Âä®Â∞ÅË£ÖÊúçÂä°Ë∞ÉÁî®ÂÆ¢Êà∑Á´ØÁöÑÂºÄÂèëÈáè„ÄÇ

FeignÈõÜÊàê‰∫ÜRibbon„ÄÇ

Âà©Áî®RibbonÁª¥Êä§‰∫ÜPaymentÁöÑÊúçÂä°ÂàóË°®‰ø°ÊÅØÔºåÂπ∂‰∏îÈÄöËøáËΩÆËØ¢ÂÆûÁé∞Á´ØÁöÑË¥üËΩΩÂùáË°°ÔºåËÄå‰∏éRibbon‰∏çÂêåÁöÑÊòØÔºåÈÄöËøáFeign‰∏çÂêåÁöÑÊòØÔºåÈÄöËøáFeignÂè™ÈúÄË¶ÅÂÆö‰πâÊúçÂä°ÁªëÂÆöÊé•Âè£‰∏î‰ª•Â£∞ÊòéÂºèÁöÑÊñπÊ≥ïÔºå‰ºòÈõÖËÄåÁÆÄÂçïÁöÑÂÆûÁé∞‰∫ÜÊúçÂä°Ë∞ÉÁî®„ÄÇ



|                            Feign                             |                          OpenFeign                           |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| FeignÊòØSpringCloudÁªÑ‰ª∂‰∏≠ÁöÑ‰∏Ä‰∏™ËΩªÈáèÁ∫ßRESTfulÁöÑHTTPÊúçÂä°ÂÆ¢Êà∑Á´Ø„ÄÇFeignÂÜÖÁΩÆ‰∫ÜRibbonÔºåÁî®Êù•ÂÅöÂÆ¢Êà∑Á´ØË¥üËΩΩÂùáË°°ÔºåÂéªË∞ÉÁî®ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊúçÂä°„ÄÇFeignÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºö‰ΩøÁî®FeignÁöÑÊ≥®Ëß£ÂÆö‰πâÊé•Âè£ÔºåË∞ÉÁî®Ëøô‰∏™Êé•Âè£ÔºåÂ∞±ÂèØ‰ª•Ë∞ÉÁî®ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊúçÂä°„ÄÇ | OpenFeignÊòØSpring CloudÂú®FeignÁöÑÂü∫Á°Ä‰∏äÊîØÊåÅ‰∫ÜSpringMVCÁöÑÊ≥®Ëß£ÔºåÂ¶Ç@RequestMappingÁ≠âÁ≠â„ÄÇOpenFeignÁöÑ@FeignClientÂèØ‰ª•Ëß£ÊûêSpringMVCÁöÑ@RequestMappingÊ≥®Ëß£‰∏ãÁöÑÊé•Âè£ÔºåÂπ∂ÈÄöËøáÂä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºè‰∫ßÁîüÂÆûÁé∞Á±ªÔºåÂÆûÁé∞Á±ª‰∏≠ÂÅöË¥üËΩΩÂùáË°°Âπ∂Ë∞ÉÁî®ÂÖ∂‰ªñÊúçÂä°„ÄÇ |
| <dependency>     <groupId>org.springframework.cloud</groupId>     <artifactId>spring-cloud-starter-feign</artifactId> </dependency> | <dependency>     <groupId>org.springframework.cloud</groupId>     <artifactId>spring-cloud-starter-openfeign</artifactId> </dependency> |



> Ë∂ÖÊó∂ÊéßÂà∂

ÈªòËÆ§FeignÂÆ¢Êà∑Á´ØÂè™Á≠âÂæÖ1ÁßíÈíüÔºå‰ΩÜÊòØÊúçÂä°Á´ØÂ§ÑÁêÜÈúÄË¶ÅË∂ÖËøá1ÁßíÈíüÔºåÂØºËá¥FeignÂÆ¢Êà∑Á´Ø‰∏çÊÉ≥Á≠âÂæÖÔºåÁõ¥Êé•ËøîÂõûÊä•Èîô„ÄÇ‰∏∫‰∫ÜÈÅøÂÖçËøôÊ†∑ÁöÑÊÉÖÂÜµÔºåÊúâÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅËÆæÁΩÆFeignÂÆ¢Êà∑Á´ØÁöÑË∂ÖÊó∂ÊéßÂà∂„ÄÇ

```yml
# ËÆæÁΩÆfeignÂÆ¢Êà∑Á´ØË∂ÖÊó∂Êó∂Èó¥(OpenfeignÈªòËÆ§ÊîØÊåÅribbon)
ribbon:
  # ÊåáÁöÑÊòØÂª∫Á´ãËøûÊé•ÊâÄÁî®ÁöÑÊó∂Èó¥ÔºåÈÄÇÁî®‰∫éÁΩëÁªúÁä∂ÂÜµÊ≠£Â∏∏ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏§Á´ØËøûÊé•ÊâÄÁî®ÁöÑÊó∂Èó¥
  ReadTimeout: 5000
  # ÊåáÁöÑÊòØÂª∫Á´ãËøûÊé•Âêé‰ªéÊúçÂä°Âô®ËØªÂèñÂà∞ÂèØÁî®ËµÑÊ∫êÊâÄÁî®ÁöÑÊó∂Èó¥
  ConnectTimeout: 5000
```



## üî∞ ÊúçÂä°ÈôçÁ∫ß



ÊúçÂä°Èõ™Â¥©

Â§ö‰∏™ÂæÆÊúçÂä°‰πãÈó¥Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÂÅáËÆæÂæÆÊúçÂä°AË∞ÉÁî®ÂæÆÊúçÂä°BÂíåÂæÆÊúçÂä°CÔºåÂæÆÊúçÂä°BÂíåÂæÆÊúçÂä°CÂèàË∞ÉÁî®ÂÖ∂‰ªñÁöÑÊúçÂä°Âô®ÔºåËøôÂ∞±ÊòØÊâÄË∞ìÁöÑ‚ÄúÊâáÂá∫‚Äù„ÄÇÂ¶ÇÊûúÊâáÂá∫ÁöÑÈìæË∑Ø‰∏äÊüê‰∏™ÂæÆÊúçÂä°ÁöÑË∞ÉÁî®ÂìçÂ∫îÊó∂Èó¥ËøáÈïøÊàñËÄÖ‰∏çÂèØÁî®ÔºåÂØπÂæÆÊúçÂä°AÁöÑË∞ÉÁî®Â∞±‰ºöÂç†Áî®Ë∂äÊù•Ë∂äÂ§öÁöÑÁ≥ªÁªüËµÑÊ∫êÔºåËøõËÄåÂºïËµ∑Á≥ªÁªüÂ¥©Ê∫ÉÔºåÊâÄË∞ìÁöÑ‚ÄúÈõ™Â¥©ÊïàÂ∫î‚Äù„ÄÇ

ÂØπ‰∫éÈ´òÊµÅÈáèÁöÑÂ∫îÁî®Êù•ËØ¥ÔºåÂçï‰∏ÄÁöÑÂêéÁ´Ø‰æùËµñÂèØËÉΩ‰ºöÂØºËá¥ÊâÄÊúâÊúçÂä°Âô®‰∏äÁöÑÊâÄÊúâËµÑÊ∫êÈÉΩÂú®Âá†ÁßíÈíüÂÜÖÈ•±Âíå„ÄÇÊØîÂ§±Ë¥•Êõ¥Á≥üÁ≥ïÁöÑÊòØÔºåËøô‰∫õÂ∫îÁî®Á®ãÂ∫èËøòÂèØËÉΩÂØºËá¥ÊúçÂä°‰πãÈó¥ÁöÑÂª∂ËøüÂ¢ûÂä†ÔºåÂ§á‰ªΩÈòüÂàóÔºåÁ∫øÁ®ãÂíåÂÖ∂‰ªñËµÑÊ∫êÁ¥ßÂº†ÔºåÂØºËá¥Êï¥‰∏™Á≥ªÁªüÂèëÁîüÊõ¥Â§öÁöÑÁ∫ßËÅîÊïÖÈöú„ÄÇËøô‰∫õÈÉΩË°®Á§∫ÈúÄË¶ÅÂØπÊïÖÈöúÂíåÂª∂ËøüËøõË°åÈöîÁ¶ªÂíåÁÆ°ÁêÜÔºå‰ª•‰æøÂçï‰∏™‰æùËµñÂÖ≥Á≥ªÁöÑÂ§±Ë¥•Ôºå‰∏çËÉΩÂèñÊ∂àÊï¥‰∏™Â∫îÁî®Á®ãÂ∫èÊàñÁ≥ªÁªü„ÄÇ

ÈÄöÂ∏∏‰∏Ä‰∏™Ê®°Âùó‰∏ãÁöÑÊüê‰∏™ÂÆû‰æãÂ§±Ë¥•ÂêéÔºåËøôÊó∂ÂÄôËøô‰∏™Ê®°Âùó‰æùÁÑ∂Ëøò‰ºöÊé•Êî∂ÊµÅÈáèÔºåÁÑ∂ÂêéËøô‰∏™ÊúâÈóÆÈ¢òÁöÑÊ®°ÂùóËøòË∞ÉÁî®‰∫ÜÂÖ∂‰ªñÁöÑÊ®°ÂùóÔºåËøôÊ†∑Â∞±‰ºöÂèëÁîüÁ∫ßËÅîÊïÖÈöúÔºåÊàñËÄÖÂè´Èõ™Â¥©„ÄÇ



### ‚ö° Hystrix



> ËØ¥Êòé

Github: https://github.com/Netflix/Hystrix

Hystrix‰∏çÂÜç‰∏ªÂä®ÂºÄÂèëÔºåÂπ∂‰∏îÂΩìÂâçÂ§Ñ‰∫éÁª¥Êä§Ê®°Âºè„ÄÇ

HystrixÔºà1.5.18ÁâàÔºâË∂≥Â§üÁ®≥ÂÆöÔºåÂèØ‰ª•Êª°Ë∂≥NetflixÁé∞ÊúâÂ∫îÁî®Á®ãÂ∫èÁöÑÈúÄÊ±Ç„ÄÇ



> Ê¶ÇËø∞

Âú®ÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠Ôºå‰∏çÂèØÈÅøÂÖçÂú∞‰ºöÊúâËÆ∏Â§öÊúçÂä°‰æùËµñÈ°π‰∏≠ÁöÑÊüê‰∫õÂ§±Ë¥•„ÄÇHystrixÊòØ‰∏Ä‰∏™Â∫ìÔºåÂèØÈÄöËøáÊ∑ªÂä†Âª∂ËøüÂÖ¨Â∑ÆÂíåÂÆπÈîôÈÄªËæëÊù•Â∏ÆÂä©ÊÇ®ÊéßÂà∂Ëøô‰∫õÂàÜÂ∏ÉÂºèÊúçÂä°‰πãÈó¥ÁöÑ‰∫§‰∫í„ÄÇHystrixÈÄöËøáÈöîÁ¶ªÊúçÂä°‰πãÈó¥ÁöÑËÆøÈóÆÁÇπÔºåÂÅúÊ≠¢ÊúçÂä°‰πãÈó¥ÁöÑÁ∫ßËÅîÊïÖÈöúÂπ∂Êèê‰æõÂêéÂ§áÈÄâÈ°πÊù•ÂÆûÁé∞Ê≠§ÁõÆÁöÑÔºå‰ª•ÊèêÈ´òÁ≥ªÁªüÁöÑÊï¥‰ΩìÂºπÊÄß„ÄÇ

‚ÄúÊñ≠Ë∑ØÂô®‚ÄùÊú¨Ë∫´ÊòØ‰∏ÄÁßçÂºÄÂÖ≥Ë£ÖÁΩÆÔºåÂΩìÊüê‰∏™ÊúçÂä°ÂçïÂÖÉÂèëÁîüÊïÖÈöú‰πãÂêéÔºåÈÄöËøáÊñ≠Ë∑ØÂô®ÁöÑÊïÖÈöúÁõëÊéßÔºàÁ±ª‰ººÁÜîÊñ≠‰øùÈô©‰∏ùÔºâÔºåÂêëË∞ÉÁî®ÊñπËøîÂõû‰∏Ä‰∏™Á¨¶ÂêàÈ¢ÑÊúüÁöÑ„ÄÅÂèØÂ§ÑÁêÜÁöÑÂ§áÈÄâÂìçÂ∫îÔºàFallbackÔºâÔºåËÄå‰∏çÊòØÈïøÊó∂Èó¥ÁöÑÁ≠âÂæÖÊàñËÄÖÊäõÂá∫Ë∞ÉÁî®ÊñπÊó†Ê≥ïÂ§ÑÁêÜÁöÑÂºÇÂ∏∏ÔºåËøôÊ†∑Â∞±‰øùËØÅ‰∫ÜÊúçÂä°Ë∞ÉÁî®ÊñπÁöÑÁ∫øÁ®ã‰∏ç‰ºöË¢´ÈïøÊó∂Èó¥„ÄÅ‰∏çÂøÖË¶ÅÂú∞Âç†Áî®Ôºå‰ªéËÄåÈÅøÂÖç‰∫ÜÊïÖÈöúÂú®ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑËîìÂª∂Ôºå‰πÉËá≥Èõ™Â¥©„ÄÇ



> ‰ΩúÁî®

- Êèê‰æõ‰øùÊä§Âπ∂ÊéßÂà∂Âª∂ËøüÂíåÂ§±Ë¥•Ôºå‰ª•ÂèäÈÄöËøáÁ¨¨‰∏âÊñπÂÆ¢Êà∑Á´ØÂ∫ìËÆøÈóÆÁöÑ‰æùËµñÈ°πÁöÑÂ§±Ë¥•
- ÂÅúÊ≠¢Â§çÊùÇÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÁ∫ßËÅîÊïÖÈöú
- Âø´ÈÄüÂ§±Ë¥•Âπ∂Âø´ÈÄü‰øÆÂ§ç
- ÂõûÈÄÄÂπ∂Âú®ÂèØËÉΩÁöÑÊÉÖÂÜµ‰∏ãÊ≠£Â∏∏ÈôçÁ∫ß
- ÂêØÁî®ÂÆûÊó∂ÁõëËßÜ„ÄÅË≠¶Êä•ÂíåÊìç‰ΩúÊéßÂà∂



> Âπ∂ÂèëÂú∫ÊôØ

1Ô∏è‚É£Âπ∂ÂèëÂú∫ÊôØÂèäËß£ÂÜ≥Ë¶ÅÊ±Ç

- Ë∂ÖÊó∂ÂØºËá¥ÊúçÂä°Âô®ÂèòÊÖ¢ÔºàËΩ¨ÂúàÔºâ=> Ë∂ÖÊó∂‰∏çÂÜçÁ≠âÂæÖ
- Âá∫ÈîôÔºàÂÆïÊú∫ÊàñÁ®ãÂ∫èËøêË°åÂá∫ÈîôÔºâ=> Âá∫ÈîôË¶ÅÊúâÂÖúÂ∫ï

2Ô∏è‚É£Ëß£ÂÜ≥ÊñπÊ°à

- ÊúçÂä°Êèê‰æõËÄÖË∂ÖÊó∂ÔºåÊúçÂä°Ë∞ÉÁî®ËÄÖ‰∏çËÉΩ‰∏ÄÁõ¥Âç°Ê≠ªÁ≠âÂæÖÔºåÂøÖÈ°ªÊúâÊúçÂä°ÈôçÁ∫ß
- ÊúçÂä°Êèê‰æõËÄÖÂÆïÊú∫ÔºåÊúçÂä°Ë∞ÉÁî®ËÄÖ‰∏çËÉΩ‰∏ÄÁõ¥Âç°Ê≠ªÁ≠âÂæÖÔºåÂøÖÈ°ªÊúâÊúçÂä°ÈôçÁ∫ß
- ÊúçÂä°Êèê‰æõËÄÖÊ≠£Â∏∏ÔºåÊúçÂä°Ë∞ÉÁî®ËÄÖËá™Â∑±Âá∫ÊïÖÈöúÊàñÊúâËá™ÊàëË¶ÅÊ±ÇÔºàËá™Â∑±ÁöÑÁ≠âÂæÖÊó∂Èó¥Â∞è‰∫éÊúçÂä°Êó∂Èó¥ÔºâÔºå



> ÊúçÂä°ÈôçÁ∫ß

1Ô∏è‚É£Ê¶ÇÂøµ

ÂΩìÊúçÂä°Âô®ÂéãÂäõÂâßÂ¢ûÁöÑÊÉÖÂÜµ‰∏ãÔºåÊ†πÊçÆÂΩìÂâç‰∏öÂä°ÊÉÖÂÜµÂèäÊµÅÈáèÂØπ‰∏Ä‰∫õÊúçÂä°ÂíåÈ°µÈù¢ÊúâÁ≠ñÁï•ÁöÑÈôçÁ∫ßÔºå‰ª•Ê≠§ÈáäÊîæÊúçÂä°Âô®ËµÑÊ∫ê‰ª•‰øùËØÅÊ†∏ÂøÉ‰ªªÂä°ÁöÑÊ≠£Â∏∏ËøêË°å„ÄÇ

ÊúçÂä°Âô®ÂøôÔºåËØ∑Á®çÂêéÂÜçËØïÔºå‰∏çËÆ©ÂÆ¢Êà∑Á´ØÁ≠âÂæÖÂπ∂Á´ãÂàªËøîÂõû‰∏Ä‰∏™ÂèãÂ•ΩÊèêÁ§∫„ÄÇ

2Ô∏è‚É£Ëß¶Âèë

- Á®ãÂ∫èËøêË°åÂºÇÂ∏∏
- Ë∂ÖÊó∂
- ÊúçÂä°ÁÜîÊñ≠
- Á∫øÁ®ãÊ±†/‰ø°Âè∑ÈáèÊâìÊª°

3Ô∏è‚É£Ëß£ÂÜ≥

ÈôçÁ∫ßÈÖçÁΩÆÔºö

ÊúçÂä°Êèê‰æõËÄÖËÆæÁΩÆËá™Ë∫´Ë∞ÉÁî®Ë∂ÖÊó∂Êó∂Èó¥ÁöÑÂ≥∞ÂÄºÔºåÂ≥∞ÂÄºÂÜÖÂèØ‰ª•Ê≠£Â∏∏ËøêË°åÔºõ

Ë∂ÖËøá‰∫ÜÈúÄË¶ÅÊúâÂÖúÂ∫ïÁöÑÊñπÊ≥ïÂ§ÑÁêÜÔºå‰ΩúÊúçÂä°ÈôçÁ∫ßfallback„ÄÇ



> ÊúçÂä°ÁÜîÊñ≠

1Ô∏è‚É£ÁÜîÊñ≠Êú∫Âà∂

ÁÜîÊñ≠Êú∫Âà∂ÊòØÂ∫îÂØπÈõ™Â¥©ÊïàÂ∫îÁöÑ‰∏ÄÁßçÂæÆÊúçÂä°ÈìæË∑Ø‰øùÊä§Êú∫Âà∂„ÄÇÂΩìÊâáÂá∫ÈìæË∑ØÁöÑÊüê‰∏™‰∏∫ÂâØÊä§Âá∫Èîô‰∏çÂèØÁî®ÊàñËÄÖÁõ∏ÂìçÂ∫îÊó∂Èó¥Â§™ÈïøÊó∂Ôºå‰ºöËøõË°åÊúçÂä°ÁöÑÈôçÁ∫ßÔºåËøõËÄåÁÜîÊñ≠ËØ•ËäÇÁÇπÂæÆÊúçÂä°ÁöÑË∞ÉÁî®ÔºåÂø´ÈÄüËøîÂõûÈîôËØØÁöÑÂìçÂ∫î‰ø°ÊÅØ„ÄÇ

ÂΩìÊâáÂá∫ÈìæË∑ØÁöÑÊüê‰∏™ÂæÆÊúçÂä°‰∏çÂèØÁî®ÊàñËÄÖÂìçÂ∫îÊó∂Èó¥Â§™ÈïøÊó∂Ôºå‰ºöËøõË°åÊúçÂä°ÁöÑÈôçÁ∫ßÔºåËøõËÄåÁÜîÊñ≠ËØ•ËäÇÁÇπÂæÆÊúçÂä°ÁöÑË∞ÉÁî®ÔºåÂø´ÈÄüËøîÂõû‚ÄùÈîôËØØ‚ÄùÁöÑÂìçÂ∫î‰ø°ÊÅØ„ÄÇÂΩìÊ£ÄÊµãÂà∞ËØ•ËäÇÁÇπÂæÆÊúçÂä°ÂìçÂ∫îÊ≠£Â∏∏ÂêéÊÅ¢Â§çË∞ÉÁî®ÈìæË∑Ø„ÄÇ

2Ô∏è‚É£Êñ≠Ë∑ØÂô®

Êñ≠Ë∑ØÂô®ÁöÑ‰∏â‰∏™ÈáçË¶ÅÂèÇÊï∞Ôºö

- Âø´ÁÖßÊó∂Èó¥Á™óÔºöÊñ≠Ë∑ØÂô®Á°ÆÂÆöÊòØÂê¶ÊâìÂºÄÈúÄË¶ÅÁªüËÆ°‰∏Ä‰∏ãËØ∑Ê±ÇÂíåÈîôËØØÊï∞ÊçÆÔºåËÄåÁªüËÆ°ÁöÑÊó∂Èó¥ËåÉÂõ¥Â∞±ÊòØÂø´ÁÖßÊó∂Èó¥Á™óÔºåÈªòËÆ§‰∏∫ÊúÄËøëÁöÑ10Áßí„ÄÇ
- ËØ∑Ê±ÇÊÄªÊï∞ÈòàÂÄºÔºöÂú®Âø´ÁÖßÊó∂Èó¥Á™óÂÜÖÔºåÂøÖÈ°ªÊª°Ë∂≥ËØ∑Ê±ÇÊÄªÊï∞ÈòàÂÄºÊâçÊúâËµÑÊ†ºÁÜîÊñ≠„ÄÇÈªòËÆ§‰∏∫20ÔºåÊÑèÂë≥ÁùÄÂú®10ÁßíÂÜÖÔºåÂ¶ÇÊûúÂú®hystrixÂëΩ‰ª§ÁöÑË∞ÉÁî®Ê¨°Êï∞‰∏çË∂≥20Ê¨°ÔºåÂç≥‰ΩøÊâÄÊúâÁöÑËØ∑zÊ±ÇÈÉΩË∂ÖÊó∂ÊàñÂÖ∂‰ªñÂéüÂõ†Â§±Ë¥•ÔºåÊñ≠Ë∑ØÂô®ÈÉΩ‰∏ç‰ºöÊâìÂºÄ„ÄÇ
- ÈîôËØØÁôæÂàÜÊØîÈòàÂÄºÔºöÂΩìËØ∑Ê±ÇÊÄªÊï∞Âú®Âø´ÁÖßÊó∂Èó¥Á™óÂÜÖË∂ÖËøá‰∫ÜÈòàÂÄºÔºåÊØîÂ¶ÇÂèëÁîü‰∫Ü30Ê¨°Ë∞ÉÁî®ÔºåÂ¶ÇÊûúÂú®Ëøô30Ê¨°Ë∞ÉÁî®‰∏≠ÔºåÊúâ15Ê¨°ÂèëÁîü‰∫ÜË∂ÖÊó∂ÂºÇÂ∏∏Ôºå‰πüÂ∞±ÊòØË∂ÖËøá50%ÁöÑÈîôËØØÁôæÂàÜÊØîÔºåÂú®ÈªòËÆ§ËÆæÂÆö50%ÈòàÂÄºÊÉÖÂÜµ‰∏ãÔºåËøôÊó∂ÂÄôÂ∞±‰ºöÂ∞ÜÊñ≠Ë∑ØÂô®ÊâìÂºÄ„ÄÇ

ÂºÄÂêØÊàñËÄÖÂÖ≥Èó≠ÁöÑÊù°‰ª∂Ôºö

- ÂΩìÊª°Ë∂≥‰∏ÄÂÆöÁöÑÈòàÂÄºÁöÑÊó∂ÂÄôÔºàÈªòËÆ§10ÁßíÂÜÖË∂ÖËøá20Âì•ËØ∑Ê±ÇÊ¨°Êï∞Ôºâ
- ÂΩìÂ§±Ë¥•ÁéáËææÂà∞‰∏ÄÂÆöÁöÑÊó∂ÂÄôÔºàÈªòËÆ§10ÁßíÂÜÖË∂ÖËøá50%ÁöÑËØ∑Ê±ÇÂ§±Ë¥•Ôºâ
- Âà∞Ëææ‰ª•‰∏äÈòàÂÄºÔºåÊñ≠Ë∑ØÂô®Â∞Ü‰ºöÂºÄÂêØ
- ÂΩìÂºÄÂêØÁöÑÊó∂ÂÄôÔºåÊâÄÊúâËØ∑Ê±ÇÈÉΩ‰∏ç‰ºöËøõË°åËΩ¨Âèë
- ‰∏ÄÊÆµÊó∂Èó¥‰πãÂêéÔºàÈªòËÆ§ÊòØ5ÁßíÔºâÔºåËøô‰∏™Êó∂ÂÄôÊñ≠Ë∑ØÂô®ÊòØÂçäÂºÄÁä∂ÊÄÅÔºå‰ºöËÆ©ÂÖ∂‰∏≠‰∏Ä‰∏™ËØ∑Ê±ÇËøõË°åËΩ¨Âèë„ÄÇÂ¶ÇÊûúÊàêÂäüÔºåÊñ≠Ë∑ØÂô®‰ºöÂÖ≥Èó≠ÔºåËã•Â§±Ë¥•ÔºåÁªßÁª≠ÂºÄÂêØ„ÄÇÈáçÂ§ç4Âíå5„ÄÇ

Êñ≠Ë∑ØÂô®ÊâìÂºÄ‰πãÂêéÔºö

- ÂÜçÊúâËØ∑Ê±ÇË∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÂ∞Ü‰∏ç‰ºöË∞ÉÁî®‰∏ªÈÄªËæëÔºåËÄåÊòØÁõ¥Êé•Ë∞ÉÁî®ÈôçÁ∫ßfallbackÔºåÈÄöËøáÊñ≠Ë∑ØÂô®ÔºåÂÆûÁé∞‰∫ÜËá™Âä®Âú∞ÂèëÁé∞ÈîôËØØÂπ∂Â∞ÜÈôçÁ∫ßÈÄªËæëÂàáÊç¢‰∏∫‰∏ªÈÄªËæëÔºåÂáèÂ∞ëÂìçÂ∫îÂª∂ËøüÁöÑÊïàÊûú„ÄÇ
- ÊÅ¢Â§çÂéüÊù•ÁöÑ‰∏ªÈÄªËæëÔºö
  - ÂØπ‰∫éËøô‰∏ÄÈóÆÈ¢òÔºåhystrix‰πü‰∏∫Êàë‰ª¨ÂÆûÁé∞‰∫ÜËá™Âä®ÊÅ¢Â§çÂäüËÉΩ„ÄÇ
  - ÂΩìÊñ≠Ë∑ØÂô®ÊâìÂºÄÔºåÂØπ‰∏ªÈÄªËæëËøõË°åÁÜîÊñ≠‰πãÂêéÔºåhystrix‰ºöÂêØÂä®‰∏Ä‰∏™‰ºëÁú†Êó∂Èó¥Á™óÔºåÂú®Ëøô‰∏™Êó∂Èó¥Á™óÂÜÖÔºåÈôçÁ∫ßÈÄªËæëÊòØ‰∏¥Êó∂ÁöÑÊàê‰∏∫‰∏ªÈÄªËæëÔºåÂΩì‰ºëÁú†Êó∂Èó¥Á™óÂà∞ÊúüÔºåÊñ≠Ë∑ØÂô®Â∞ÜËøõÂÖ•ÂçäÂºÄÁä∂ÊÄÅÔºåÈáäÊîæ‰∏ÄÊ¨°ËØ∑Ê±ÇÂà∞ÂéüÊù•ÁöÑ‰∏ªÈÄªËæë‰∏äÔºåÂ¶ÇÊûúÊ≠§Ê¨°ËØ∑Ê±ÇÊ≠£Â∏∏ËøîÂõûÔºåÈÇ£‰πàÊñ≠Ë∑ØÂô®Â∞ÜÁªßÁª≠Èó≠ÂêàÔºå‰∏ªÈÄªËæëÊÅ¢Â§çÔºåÂ¶ÇÊûúËøôÊ¨°ËØ∑Ê±Ç‰æùÁÑ∂ÊúâÈóÆÈ¢òÔºåÊñ≠Ë∑ØÂô®ÁªßÁª≠ËøõÂÖ•ÊâìÂºÄÁä∂ÊÄÅÔºå‰ºëÁú†Êó∂Èó¥Á™óÈáçÊñ∞ËÆ°Êó∂„ÄÇ



> DashboardÁõëÊéß

HystrixÊèê‰æõ‰∫ÜÂáÜÂÆûÊó∂ÁöÑË∞ÉÁî®ÁõëÊéßÔºàHystrix DashboardÔºâÔºåHystrix‰ºöÊåÅÁª≠Âú∞ËÆ∞ÂΩïÊâÄÊúâÈÄöËøáHystrixÂèëËµ∑ÁöÑËØ∑Ê±ÇÁöÑÊâßË°å‰ø°ÊÅØÔºåÂπ∂‰ª•ÁªüËÆ°Êä•Ë°®ÂíåÂõæÂΩ¢ÁöÑÂΩ¢ÂºèÂ±ïÁ§∫ÁªôÁî®Êà∑ÔºåÂåÖÊã¨ÊØèÁßíÊâßË°åÂ§öÂ∞ëËØ∑Ê±ÇÊàêÂäü„ÄÅÂ§öÂ∞ëÂ§±Ë¥•Á≠â„ÄÇNetflixÈÄöËøáhystrix-metrics-event-streamÈ°πÁõÆÂÆûÁé∞‰∫ÜÂØπ‰ª•‰∏äÊåáÊ†áÁöÑÁõëÊéß„ÄÇSpring CloudÂ§úÊèê‰æõ‰∫ÜHystrix DashboardÁöÑÊï¥ÂêàÔºåÂØπÁõëÊéßÂÜÖÂÆπËΩ¨Êç¢ÊàêÂèØËßÜÂåñÁïåÈù¢„ÄÇ



> POM

```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-hystrix-dashboard</artifactId>
</dependency>
```

> YML

```yml
server:
  port: 9001

spring:
  application:
    name: cloud-consumer-hystrix-dashboard

eureka:
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://eureka7001.com:7001/eureka
  instance:
    prefer-ip-address: true
```

> Main

```java
@SpringBootApplication
@EnableHystrixDashboard
public class HystrixDashboardMain9001Application {
    public static void main(String[] args) {
        SpringApplication.run(HystrixDashboardMain9001Application.class, args);
    }
}
```

ËæìÂÖ•http://localhost:8001/hystrix.streamÂç≥ÂèØËøõË°åÁõëÊéßÔºö

![image-20210119232242203](SpringCloud/image-20210119232242203.png)



## üåêÊúçÂä°ÁΩëÂÖ≥



### üéáSpring Cloud Gateway



> Ê¶ÇËø∞

Spring Cloud GatewayÊó∂Spring CloudÁöÑ‰∏Ä‰∏™ÂÖ®Êñ∞È°πÁõÆÔºåÂü∫‰∫éSpring 5.0  + Spring Boot 2.0ÂíåProject ReactorÁ≠âÊäÄÊúØÂºÄÂèëÁöÑÁΩëÂÖ≥ÔºåÂÆÉÊó®Âú®‰∏∫ÂæÆÊúçÂä°Êû∂ÊûÑÊèê‰æõ‰∏ÄÁßçÁÆÄÂçïÊúâÊïàÁöÑÁªü‰∏ÄÁöÑAPIË∑ØÁî±ÁÆ°ÁêÜÊñπÂºè„ÄÇ

SpringCloud Gateway‰Ωú‰∏∫Spring CloudÁîüÊÄÅÁ≥ªÁªü‰∏≠ÁöÑÁΩëÂÖ≥ÔºåÁõÆÊ†áÊòØÊõø‰ª£ZuulÔºåÂú®Spring Cloud 2.0‰ª•‰∏äÁâàÊú¨‰∏≠ÔºåÊ≤°ÊúâÂØπÊñ∞ÁâàÊú¨ÁöÑZuul 2.0‰ª•‰∏äÊúÄÊñ∞È´òÊÄßËÉΩÁâàÊú¨ËøõË°åÈõÜÊàêÔºå‰ªçÁÑ∂ËøòÊòØ‰ΩøÁî®ÁöÑZuul 1.xÈùûReactorÊ®°ÂºèÁöÑËÄÅÁâàÊú¨ÔºåËÄå‰∏∫‰∫ÜÊèê‰æõÁΩëÂÖ≥ÁöÑÊÄßËÉΩÔºåSpringCloud GatewayÊòØÂü∫‰∫éWebFluxÊ°ÜÊû∂ÂÆûÁé∞ÁöÑÔºåËÄåWebFluxÊ°ÜÊû∂Â∫ïÂ±ÇÂàô‰ΩøÁî®‰∫ÜÈ´òÊÄßËÉΩÁöÑReactorÊ®°ÂºèÈÄö‰ø°Ê°ÜÊû∂Netty„ÄÇ

Spring Cloud GatewayÁöÑÁõÆÊ†áÊòØÊèê‰æõÁªü‰∏ÄÁöÑË∑ØÁî±ÊñπÂºè‰∏îÂü∫‰∫éFilterÈìæÁöÑÊñπÂºèÊèê‰æõ‰∫ÜÁΩëÂÖ≥Âü∫Êú¨ÁöÑÂäüËÉΩÔºå‰æãÂ¶ÇÔºöÂÆâÂÖ®„ÄÅÁõëÊéß/ÊåáÊ†áÂíåÈôêÊµÅ„ÄÇ



> Ê†∏ÂøÉÊ¶ÇÂøµ

1Ô∏è‚É£Route(Ë∑ØÁî±)

Ë∑ØÁî±ÊòØÊûÑÂª∫ÁΩëÂÖ≥ÁöÑÂü∫Êú¨Ê®°ÂùóÔºåÂÆÉÁî±ID„ÄÅÁõÆÊ†áURI„ÄÅ‰∏ÄÁ≥ªÂàóÁöÑÊñ≠Ë®ÄÂíåËøáÊª§Âô®ÁªÑÊàêÔºåÂ¶ÇÊûúÊñ≠Ë®Ä‰∏∫trueÂàôÂåπÈÖçËØ•Ë∑ØÁî±„ÄÇ

2Ô∏è‚É£Predicate(Êñ≠Ë®Ä)

ÂèÇËÄÉÁöÑÊòØJava8ÁöÑjava.util.function.Predicate„ÄÇÂºÄÂèë‰∫∫ÂëòÂèØ‰ª•ÂåπÈÖçHTTPËØ∑Ê±Ç‰∏≠ÁöÑÊâÄÊúâÂÜÖÂÆπ(‰æãÂ¶ÇËØ∑Ê±ÇÂ§¥ÊàñËØ∑Ê±ÇÂèÇÊï∞)ÔºåÂ¶ÇÊûúËØ∑Ê±Ç‰∏éÊñ≠Ë®ÄÁõ∏ÂåπÈÖçÂàôËøõË°åË∑ØÁî±„ÄÇ

3Ô∏è‚É£Filter(ËøáÊª§)

ÊåáÁöÑÊòØSpringÊ°ÜÊû∂‰∏≠Gateway FilterÁöÑÂÆû‰æãÔºå‰ΩøÁî®ËøáÊª§Âô®ÔºåÂèØ‰ª•Âú®ËØ∑Ê±ÇË¢´Ë∑ØÁî±ÂâçÊàñËÄÖ‰πãÂêéÂØπËØ∑Ê±Ç‰øÆÊîπ„ÄÇ



> ÈÄâÂûãËØ¥Êòé

- Zuul1.0Â∑≤ÁªèËøõÂÖ•Áª¥Êä§Èò∂ÊÆµÔºåGatewayÊòØSpringCloudÂõ¢ÈòüÁ†îÂèëÁöÑÔºåÊòØ‰∫≤ÂÑøÂ≠ê‰∫ßÂìÅÔºåÂÄºÂæó‰ø°Ëµñ„ÄÇËÄå‰∏îGatewayÂæàÂ§öÂäüËÉΩZuulÈÉΩÊ≤°ÊúâÔºåÁî®Ëµ∑Êù•ÈùûÂ∏∏ÁÆÄÂçï‰æøÊç∑„ÄÇ
- GatewayÊòØÂü∫‰∫éÂºÇÊ≠•ÈòªÂ°ûÊ®°Âûã‰∏äËøõË°åÂºÄÂèëÁöÑÔºåÊÄßËÉΩÊñπÈù¢‰∏çÈúÄË¶ÅÊãÖÂøÉ„ÄÇËôΩÁÑ∂NetfliÊó©Â∞±ÂèëÂ∏É‰∫ÜÊúÄÊñ∞ÁöÑZuul2.xÔºå‰ΩÜSpringCloudË≤å‰ººÊ≤°ÊúâÊï¥ÂêàËÆ°Âàí„ÄÇËÄå‰∏îNetflixÁõ∏ÂÖ≥ÁªÑ‰ª∂ÈÉΩÂÆ£Â∏ÉËøõÂÖ•Áª¥Êä§ÊúüÔºå‰∏çÁü•ÂâçÊôØÂ¶Ç‰Ωï„ÄÇ



> ÁâπÊÄß

- Âü∫‰∫éSpring Framework 5 „ÄÅProject ReactorÂíåSpring Boot 2.0ËøõË°åÊûÑÂª∫
- Âä®ÊÄÅË∑ØÁî±ÔºöËÉΩÂ§üÂåπÈÖç‰ªª‰ΩïËØ∑Ê±ÇÂ±ûÊÄß
- ÂèØ‰ª•ÂØπË∑ØÁî±ÊåáÂÆöPredicate(Êñ≠Ë®Ä)ÂíåFilter(ËøáÊª§Âô®)
- ÈõÜÊàêHystrixÁöÑÊñ≠Ë∑ØÂô®ÂäüËÉΩ
- ÈõÜÊàêSpring CloudÊúçÂä°ÂèëÁé∞ÂäüËÉΩ
- Êòì‰∫éÁºñÂÜôÁöÑPredicate(Êñ≠Ë®Ä)ÂíåFilter(ËøáÊª§Âô®)
- ËØ∑Ê±ÇÈôêÊµÅÂäüËÉΩ
- ÊîØÊåÅË∑ØÂæÑÈáçÂÜô



> SpringCloud Gateway‰∏éZuulÁöÑÂå∫Âà´

- Zuul 1.xÊòØ‰∏Ä‰∏™Âü∫‰∫éÈòªÂ°ûI/OÁöÑAPI Gateway„ÄÇ
- Zuul 1.xÂü∫‰∫éServlet2.5‰ΩøÁî®ÈòªÂ°ûÊû∂ÊûÑÂÆÉ‰∏çÊîØÊåÅ‰ªª‰ΩïÈïøËøûÊé•(Â¶ÇWebsocket)„ÄÇZuulÁöÑËÆæËÆ°Ê®°ÂºèÂíåNginxËæÉÂÉèÔºåÊØèÊ¨°I/OÊìç‰ΩúÈÉΩÊòØ‰ªéÂ∑•‰ΩúÁ∫øÁ®ã‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÊâßË°åÔºåËØ∑Ê±ÇÁ∫øÁ®ãË¢´ÈòªÂ°ûÂà∞Â∑•‰ΩúÁ∫øÁ®ãÂÆåÊàêÔºå‰ΩÜÊòØÂ∑ÆÂà´ÊòØNginxÁî®C++ÂÆûÁé∞ÔºåZuulÁî®JavaÂÆûÁé∞ÔºåËÄåJVMÊú¨Ë∫´‰ºöÊúâÁ¨¨‰∏ÄÊ¨°Âä†ËΩΩËæÉÊÖ¢ÁöÑÊÉÖÂÜµÔºå‰ΩøÂæóZuulÁöÑÊÄßËÉΩÁõ∏ÂØπËæÉÂ∑Æ„ÄÇ
- Zuul 2.xÁêÜÂøµÊõ¥ÂÖàËøõÔºåÊÉ≥Âü∫‰∫éNettyÈùûÈòªÂ°ûÂíåÊîØÊåÅÈïøËøûÊé•Ôºå‰ΩÜSpringCloudÁõÆÂâçËøòÊ≤°ÊúâÊï¥Âêà„ÄÇZuul 2.xÁöÑÊÄßËÉΩËæÉZuul 1.xÊúâËæÉÂ§ßÊèêÂçá„ÄÇÂú®ÊÄßËÉΩÊñπÈù¢ÔºåÊ†πÊçÆÂÆòÊñπÊèê‰æõÁöÑÂü∫ÂáÜÊµãËØïÔºåSpringCloud GatewayÁöÑRPS(ÊØèÁßíËØ∑Ê±ÇÊï∞)ÊòØZuulÁöÑ1.6ÂÄç„ÄÇ
- SpringCloud Gateway‰ΩøÁî®ÈùûÈòªÂ°ûAPI„ÄÇ
- SpringCloud GatewayËøòÊîØÊåÅWebsocketÔºåÂπ∂‰∏î‰∏éSpringÁ¥ßÂØÜÈõÜÊàêÊã•ÊúâÊõ¥Â•ΩÁöÑÂºÄÂèë‰ΩìÈ™å„ÄÇ



## üî® ÊúçÂä°ÈÖçÁΩÆ



### ‚öô Spring Cloud Config



üìñÂàÜÂ∏ÉÂºèÈÖçÁΩÆ‰∏≠ÂøÉ



> Ê¶ÇËø∞

Spring Cloud Config‰∏∫ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÁöÑÂæÆÊúçÂä°Êèê‰æõÈõÜ‰∏≠ÂåñÁöÑÂ§ñÈÉ®ÈÖçÁΩÆÊîØÊåÅÔºåÈÖçÁΩÆÊúçÂä°Âô®‰∏∫ÂêÑ‰∏™‰∏çÂêåÂæÆÊúçÂä°Â∫îÁî®ÁöÑÊâÄÊúâÁéØÂ¢ÉÊèê‰æõ‰∫Ü‰∏Ä‰∏™‰∏≠ÂøÉÂåñÁöÑÂ§ñÈÉ®ÈÖçÁΩÆ„ÄÇ



> ‰ΩøÁî®

Spring Cloud ConfigÂàÜ‰∏∫ÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´Ø‰∏§ÈÉ®ÂàÜ

- ÊúçÂä°Á´ØÔºöÂàÜÂ∏ÉÂºèÈÖçÁΩÆ‰∏≠ÂøÉÔºåÂÆÉÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑÂæÆÊúçÂä°Â∫îÁî®ÔºåÁî®Êù•ËøûÊé•ÈÖçÁΩÆÊúçÂä°Âô®Âπ∂‰∏∫ÂÆ¢Êà∑Á´ØÊèê‰æõÈÖçÁΩÆ‰ø°ÊÅØÔºåÂä†ÂØÜ/Ëß£ÂØÜ‰ø°ÊÅØÁ≠âËÆøÈóÆÊé•Âè£„ÄÇ
- ÂÆ¢Êà∑Á´ØÔºöÈÄöËøáÊåáÂÆöÁöÑÈÖçÁΩÆ‰∏≠ÂøÉÊù•ÁÆ°ÁêÜÂ∫îÁî®ËµÑÊ∫êÔºå‰ª•Âèä‰∏é‰∏öÂä°Áõ∏ÂÖ≥ÁöÑÈÖçÁΩÆÂÜÖÂÆπÔºåÂπ∂Âú®ÂêØÂä®ÁöÑÊó∂ÂÄô‰ªéÈÖçÁΩÆ‰∏≠ÂøÉËé∑ÂèñÂíåÂä†ËΩΩÈÖçÁΩÆ‰ø°ÊÅØÂíåÈÖçÁΩÆÊúçÂä°Âô®ÔºåÈªòËÆ§ÈááÁî®gitÊù•Â≠òÂÇ®ÈÖçÁΩÆ‰ø°ÊÅØÔºåËøôÊ†∑Â∞±ÊúâÂä©‰∫éÂØπÁéØÂ¢ÉÈÖçÁΩÆËøõË°åÁâàÊú¨ÁÆ°ÁêÜÔºåÂπ∂‰∏îÂèØ‰ª•ÈÄöËøágitÂÆ¢Êà∑Á´ØÂ∑•ÂÖ∑Êù•Êñπ‰æøÁöÑÁÆ°ÁêÜÂíåËÆøÈóÆÈÖçÁΩÆÂÜÖÂÆπ„ÄÇ



### üöåSpring Cloud Bus



üìñÊ∂àÊÅØÊÄªÁ∫ø



> Ê¶ÇËø∞

Âú®ÂæÆÊúçÂä°Êû∂ÊûÑÁöÑÁ≥ªÁªü‰∏≠ÔºåÈÄöËøá‰ºö‰ΩøÁî®ËΩªÈáèÁ∫ßÁöÑÊ∂àÊÅØ‰ª£ÁêÜÊù•ÊûÑÂª∫‰∏Ä‰∏™ÂÖ±Áî®ÁöÑÊ∂àÊÅØ‰∏ªÈ¢òÔºåÂπ∂ËÆ©Á≥ªÁªü‰∏≠ÊâÄÊúâÂæÆÊúçÂä°ÂÆû‰æãÈÉΩËøûÊé•‰∏äÊù•ÔºåÁî±‰∫éËØ•‰∏ªÈ¢ò‰∏≠‰∫ßÁîüÁöÑÊ∂àÊÅØ‰ºöË¢´ÊâÄÊúâÂÆû‰æãÁõëÂê¨ÂíåÊ∂àË¥πÔºåÊâÄ‰ª•Áß∞ÂÆÉ‰∏∫Ê∂àÊÅØÊÄªÁ∫ø„ÄÇÂú®ÊÄªÁ∫ø‰∏äÁöÑÂêÑ‰∏™ÂÆû‰æãÔºåÈÉΩÂèØ‰ª•Êñπ‰æøÂú∞ÂπøÊí≠‰∏Ä‰∫õÈúÄË¶ÅËÆ©ÂÖ∂‰ªñËøûÊé•Âú®ËØ•‰∏ªÈ¢ò‰∏äÁöÑÂÆû‰æãÈÉΩÁü•ÈÅìÁöÑÊ∂àÊÅØ„ÄÇ



> ÂéüÁêÜ

ConfigClientÂÆû‰æãÈÉΩÁõëÂê¨MQ‰∏≠Âêå‰∏Ä‰∏™topic(ÈªòËÆ§ÊòØSpringCloudBus)„ÄÇÂΩì‰∏Ä‰∏™ÊúçÂä°Âà∑Êñ∞Êï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÂÆÉ‰ºöÊääËøô‰∏™Ê∂àÊÅØÊîæÂÖ•Âà∞Topic‰∏≠ÔºåËøôÊ†∑ÂÖ∂‰ªñÁõëÂê¨Âêå‰∏ÄTopicÁöÑÊúçÂä°Â∞±ËÉΩÂæóÂà∞ÈÄöÁü•ÔºåÁÑ∂ÂêéÂéªÊõ¥Êñ∞Ëá™Ë∫´ÁöÑÈÖçÁΩÆ„ÄÇ



> DockerËøêË°åRabbitMQ

```shell
# ÂÆâË£ÖËøêË°å
docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 -v `pwd`/data:/var/lib/rabbitmq -e RABBITMQ_DEFAULT_VHOST=/  -e RABBITMQ_DEFAULT_USER=Khighness -e RABBITMQ_DEFAULT_PASS=KAG1823 rabbitmq
# ÂºÄÂêØÂèØËßÜÂåñ
docker exec -it rabbitmq rabbitmq-plugins enable rabbitmq_management
```



### üåäSpring Cloud Stream



üìñÊ∂àÊÅØÈ©±Âä®



> Ê¶ÇËø∞

Spring Cloud StreamÊòØ‰∏Ä‰∏™ÊûÑÂª∫Ê∂àÊÅØÈ©±Âä®ÂæÆÊúçÂä°ÁöÑÊ°ÜÊû∂„ÄÇ

Â∫îÁî®Á®ãÂ∫èÈÄöËøáinputsÊàñËÄÖoutputsÊù•‰∏éSpring Cloud Stream‰∏≠binderÂØπË±°‰∫§‰∫í„ÄÇ

ÈÄöËøáÈÖçÁΩÆÊù•ÁªëÂÆöÔºåSpring Cloud StreamÁöÑbinderÂØπË±°Ë¥üË¥£‰∏éÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰∫§‰∫í„ÄÇ

ÈÄöËøá‰ΩøÁî®Spring IntergrationÊù•ËøûÊé•Ê∂àÊÅØ‰ª£ÁêÜ‰∏≠Èó¥‰ª∂‰ª•ÂÆûÁé∞Ê∂àÊÅØ‰∫ã‰ª∂È©±Âä®„ÄÇ

Spring Cloud Stream‰∏∫‰∏Ä‰∫õ‰æõÂ∫îÂïÜÁöÑÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰∫ßÂìÅÊèê‰æõ‰∫Ü‰∏™ÊÄßÂåñÁöÑËá™Âä®ÂåñÈÖçÁΩÆÂÆûÁé∞ÔºåÂºïÁî®‰∫ÜÂèëÂ∏É/ËÆ¢ÈòÖ„ÄÅÊ∂àË¥πÁªÑ„ÄÅÂàÜÂå∫‰∏â‰∏™Ê†∏ÂøÉÊ¶ÇÂøµ„ÄÇ

ÁõÆÂâç‰ªÖÊîØÊåÅ**RabbitMQ**„ÄÅ**Kafka**„ÄÇ



> ËÆæËÆ°ÊÄùÊÉ≥

Âú®Ê≤°ÊúâÁªëÂÆöÂô®Ëøô‰∏™Ê¶ÇÂøµÁöÑÊÉÖÂÜµ‰∏ãÔºåSpringBootÂ∫îÁî®Ë¶ÅÁõ¥Êé•‰∏éÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ËøõË°å‰ø°ÊÅØ‰∫§‰∫íÁöÑÊó∂ÂÄôÔºåÁî±‰∫éÂêÑÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ÊûÑÂª∫ÁöÑÂàùË°∑‰∏çÂêåÔºåÂÆÉ‰ª¨ÁöÑÂÆûÁé∞ÁªÜËäÇ‰∏ä‰ºöÊúâËæÉÂ§ßÁöÑÂ∑ÆÂºÇÊÄß„ÄÇ

**ÈÄöËøáÂÆö‰πâÁªëÂÆöÂô®‰Ωú‰∏∫‰∏≠Èó¥Â±ÇÔºåÂÆåÁæéÂú∞ÂÆûÁé∞‰∫ÜÂ∫îÁî®Á®ãÂ∫è‰∏éÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰πãÈó¥ÁöÑÈöîÁ¶ª„ÄÇ**

ÈÄöËøáÂêëÂ∫îÁî®Á®ãÂ∫èÊö¥Èú≤Áªü‰∏ÄÁöÑChannelÈÄöÈÅìÔºå‰ΩøÂæóÂ∫îÁî®Á®ãÂ∫è‰∏çÈúÄË¶ÅÂÜçËÄÉËôëÂêÑÁßç‰∏çÂêåÁöÑÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ÂÆûÁé∞„ÄÇ



> ÁªëÂÆöÂô®

![Stream](SpringCloud/Stream.png)



> Ê†áÂáÜÊµÅÁ®ãÂ•óË∑Ø

- Binder: ÂæàÊñπ‰æøÁöÑËøûÊé•‰∏≠Èó¥‰ª∂ÔºåÂ±èËîΩÂ∑ÆÂºÇ
- Channel: ÈÄöÈÅìÔºåÊòØÈòüÂàóQueueÁöÑ‰∏ÄÁßçÊäΩË±°ÔºåÂú®Ê∂àÊÅØÈÄöËÆØÁ≥ªÁªü‰∏≠Â∞±ÊòØÂÆûÁé∞Â≠òÂÇ®ÂíåËΩ¨ÂèëÁöÑÂ™í‰ªãÔºåÈÄöËøáChannelÂØπÈòüÂàóËøõË°åÈÖçÁΩÆ
- SourceÂíåSink: ‰ªéStreamÂèëÂ∏ÉÊ∂àÊÅØÂ∞±ÊòØËæìÂá∫ÔºåÊé•Êî∂Ê∂àÊÅØÂ∞±ÊòØËæìÂÖ•



> ÁºñÁ†ÅÂ∏∏Áî®Ê≥®Ëß£

<img src="SpringCloud/image-20210124190703816.png" alt="image-20210124190703816" style="zoom: 80%;" />

| ÁªÑÊàê            | ËØ¥Êòé                                                         |
| --------------- | ------------------------------------------------------------ |
| Middleware      | ‰∏≠Èó¥‰ª∂ÔºåÁõÆÂâçÂè™ÊîØÊåÅRabbitMQÂíåKafka                            |
| Binder          | BinderÊòØÂ∫îÁî®‰∏éÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰πãÈó¥ÁöÑÂ∞ÅË£ÖÔºåÁõÆÂâçÂÆûË°å‰∫ÜKafkaÂíåRabbitMQÁöÑBinderÔºåÈÄöËøáBinderÂèØ‰ª•ÂæàÊñπ‰æøÁöÑËøûÊé•‰∏≠Èó¥‰ª∂ÔºåÂèØ‰ª•Âä®ÊÄÅÁöÑÊîπÂèòÊ∂àÊÅØÁ±ªÂûã(ÂØπ‰∫éKafkaÁöÑtopicÔºåRabbitMQÁöÑexchange)ÔºåËøô‰∫õÈÉΩÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÊñá‰ª∂Êù•ÂÆûÁé∞ |
| @Input          | Ê≥®Ëß£Ê†áËØÜËæìÂÖ•ÈÄöÈÅìÔºåÈÄöËøáËØ•ËæìÂÖ•ÈÄöÈÅìÊé•Êî∂Âà∞ÁöÑÊ∂àÊÅØËøõÂÖ•Â∫îÁî®Á®ãÂ∫è     |
| @Output         | Ê≥®Ëß£Ê†áËØÜËæìÂá∫ÈÄöÈÅìÔºåÂèëÂ∏ÉÁöÑÊ∂àÊÅØÂ∞ÜÈÄöËøáËØ•ÈÄöÈÅìÁ¶ªÂºÄÂ∫îÁî®Á®ãÂ∫è         |
| @StreamListener | ÁõëÂê¨ÈòüÂàóÔºåÁî®‰∫éÊ∂àË¥πËÄÖÁöÑÈòüÂàóÁöÑÊ∂àÊÅØÊé•Êî∂                         |
| @EnableBinding  | Êåá‰ø°ÈÅìchannelÂíåexchangeÁªëÂÆöÂú®‰∏ÄËµ∑                            |



### üì∏ Spring Cloud Sleuth



> ÁóõÁÇπ

Âú®ÂæÆÊúçÂä°Ê°ÜÊû∂‰∏≠Ôºå‰∏Ä‰∏™Áî±ÂÆ¢Êà∑Á´ØÂèëËµ∑ÁöÑËØ∑Ê±ÇÂú®ÂêéÁ´ØÁ≥ªÁªü‰∏≠‰ºöÁªèËøáÂ§ö‰∏™‰∏çÂêåÁöÑÊúçÂä°ËäÇÁÇπË∞ÉÁî®Êù•ÂçèÂêå‰∫ßÁîüÊúÄÂêéÁöÑËØ∑Ê±ÇÁªìÊûúÔºåÊØè‰∏Ä‰∏™ÂâçÁ´ØËØ∑Ê±ÇÈÉΩ‰ºöÂΩ¢Êàê‰∏Ä‰∏™Â§çÊùÇÁöÑÂàÜÂ∏ÉÂºèÊúçÂä°Ë∞ÉÁî®ÈìæË∑ØÔºåÈìæË∑Ø‰∏≠ÁöÑ‰ªª‰Ωï‰∏ÄÁéØÂá∫Áé∞È´òÂª∂ËøüÊàñÈîôËØØÈÉΩ‰ºöÂºïËµ∑Êï¥‰∏™ËØ∑Ê±ÇÊúÄÂêéÁöÑÂ§±Ë¥•„ÄÇ



> zipkin

- jar

‰∏ãËΩΩÔºöhttps://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/

ËøêË°åÔºö`java -jar zipkin-server-2.12.9-exec.jar`

- docker

‰∏ãËΩΩÔºö`docker pull openzipkin/zipkin`

ËøêË°åÔºö`docker run -d --restart always -p 9411:9411 --name zipkin openzipkin/zipkin `



 ## üí• ÈòøÈáåÂ∑¥Â∑¥



### üî•  Spring Cloud Alibaba



> ËÉåÊôØ

ÂçöÂÆ¢ÂéüÊñáÔºö[spring-cloud-greenwich-rc1-available-now](https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now)

Spring Cloud NetflixÈ°πÁõÆËøõÂÖ•Áª¥Êä§Ê®°Âºè

‰ª•‰∏ãSpring Cloud NetflixÊ®°ÂùóÂíåÁõ∏Â∫îÁöÑÂêØÂä®Á®ãÂ∫èÂ∞ÜËøõÂÖ•Áª¥Êä§Ê®°ÂºèÔºö

1. spring-cloud-netflix-archaius
2. spring-cloud-netflix-hystrix-contract
3. spring-cloud-netflix-hystrix-dashboard
4. spring-cloud-netflix-hystrix-stream
5. spring-cloud-netflix-hystrix
6. spring-cloud-netflix-ribbon
7. spring-cloud-netflix-turbine-stream
8. spring-cloud-netflix-turbine
9. spring-cloud-netflix-zuul

Ëøô‰∏çÂåÖÊã¨EurekaÊàñÂπ∂ÂèëÈôêÂà∂Ê®°Âùó„ÄÇ



> ËØûÁîü

2018-10-31ÔºåSpring Cloud AlibabaÊ≠£ÂºèÂÖ•È©ª‰∫ÜSpring CloudÂÆòÊñπÂ≠µÂåñÂô®ÔºåÂπ∂Âú®Maven‰∏≠Â§Æ‰ªìÂ∫ìÂèëÂ∏É‰∫ÜÁ¨¨‰∏Ä‰∏™ÁâàÊú¨„ÄÇ

ÂÆòÊñπÊñáÊ°£Ôºö[spring-cloud-alibaba](https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_introduction)



> ÂäüËÉΩ

- ÊúçÂä°ÈôêÊµÅÈôçÁ∫ßÔºöÈªòËÆ§ÊîØÊåÅServlet„ÄÅFeign„ÄÅRestTemplate„ÄÅDuddoÂíåRocketMQÈôêÊµÅÈôçÁ∫ßÂäüËÉΩÁöÑÊé•ÂÖ•ÔºåÂèØ‰ª•Âú®ËøêË°åÊó∂ÈÄöËøáÊéßÂà∂Âè∞‰øÆÊîπÈôêÊµÅÈôçÁ∫ßËßÑÂàôÔºåËøòÊîØÊåÅÊü•ÁúãÈôêÊµÅÈôçÁ∫ßMetricsÁõëÊéß„ÄÇ
- ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞ÔºöÈÄÇÈÖçSpring CloudÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞Ê†áÂáÜÔºåÈªòËÆ§ÈõÜÊàê‰∫ÜRibbonÁöÑÊîØÊåÅ„ÄÇ
- ÂàÜÂ∏ÉÂºèÈÖçÁΩÆÁÆ°ÁêÜÔºöÊîØÊåÅÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÂ§ñÈÉ®ÂåñÈÖçÁΩÆÔºåÈÖçÁΩÆÊõ¥ÊîπÊó∂Ëá™Âä®Âà∑Êñ∞„ÄÇ
- Ê∂àÊÅØÈ©±Âä®ËÉΩÂäõÔºöÂü∫‰∫éSpring Cloud Stream‰∏∫ÂæÆÊúçÂä°Â∫îÁî®ÊûÑÂª∫Ê∂àÊÅØÈ©±Âä®ËÉΩÂäõ„ÄÇ
- ÈòøÈáå‰∫ëÂØπË±°Â≠òÂÇ®ÔºöÈòøÈáå‰∫ëÊèê‰æõÊµ∑Èáè„ÄÅÂÆâÂÖ®„ÄÅ‰ΩéÊàêÊú¨„ÄÅÈ´òÂèØÈù†ÁöÑ‰∫ëÂ≠òÂÇ®ÊúçÂä°„ÄÇÊîØÊåÅÂú®‰ªª‰ΩïÂ∫îÁî®„ÄÅ‰ªª‰ΩïÊó∂Èó¥„ÄÅ‰ªª‰ΩïÂú∞ÁÇπÂ≠òÂÇ®ÂíåËÆøÈóÆ‰ªªÊÑèÁ±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ
- ÂàÜÂ∏ÉÂºè‰ªªÂä°Ë∞ÉÂ∫¶ÔºöÊèê‰æõÁßíÁ∫ß„ÄÅÁ≤æÂáÜ„ÄÅÈ´òÂèØÈù†„ÄÅÈ´òÂèØÁî®ÁöÑÂÆöÊó∂ÔºàÂü∫‰∫éCronË°®ËææÂºèÔºâ‰ªªÂä°Ë∞ÉÂ∫¶ÊúçÂä°ÔºåÂêåÊó∂Êèê‰æõÂàÜÂ∏ÉÂºèÁöÑ‰ªªÂä°ÊâßË°åÊ®°ÂûãÔºåÂ¶ÇÁΩëÊ†º‰ªªÂä°„ÄÇÁΩëÊ†º‰ªªÂä°ÊîØÊåÅÊµ∑ÈáèÂ≠ê‰ªªÂä°ÂùáÂåÄÂàÜÈÖçÂà∞ÊâÄÊúâWorkerÔºàschedulex-clientÔºâ‰∏äÊâßË°å„ÄÇ



### ‚ôæÔ∏èNacos



> Ê¶ÇËø∞

‰∏Ä‰∏™Êõ¥Êòì‰∫éÊûÑÂª∫‰∫ëÂéüÁîüÂ∫îÁî®ÁöÑÂä®ÊÄÅÊúçÂä°ÂèëÁé∞„ÄÅÈÖçÁΩÆÁÆ°ÁêÜÂíåÊúçÂä°ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂç≥Ê≥®ÂÜå‰∏≠ÂøÉÂíåÈÖçÁΩÆ‰∏≠ÂøÉÁöÑÁªÑÂêà„ÄÇ

ÁêÜËß£ÔºöNacos = Eureka + Config + Bus

ÂÆòÁΩëÔºö[nacos](http://nacos.io)



> DockerËøêË°åNacos

```shell
# ‰∏ãËΩΩÈïúÂÉè
docker pull nacos/nacos-server:1.1.4 

# ÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂ÂíåÊó•ÂøóÊñá‰ª∂ÁõÆÂΩï
mkdir -p /opt/nacos/single/init.d /opt/nacos/single/logs 
cd /opt/nacos/single/init.d && touch custom.properties

# custom.propertiesÊñá‰ª∂‰∏≠Â°´ÂÜôÂ¶Ç‰∏ãÈÖçÁΩÆ
server.contextPath=/nacos
server.port=8848
management.endpoints.web.exposure.include=*

# ÂàõÂª∫Âπ∂ÂêØÂä®ÂÆπÂô®
docker run -d -p 8848:8848 -e MODE=standalone \
-v /opt/nacos/single/init.d/custom.properties:/home/nacos/init.d/custom.properties \
-v /opt/nacos/single/logs:/home/nacos/logs \
--restart always \
--name nacos nacos/nacos-server:1.1.4 
```



> ÁïåÈù¢

ÊâìÂºÄÊµèËßàÂô®ËæìÂÖ•: http://ip:8848/nacosÔºåË¥¶Âè∑ÂØÜÁ†ÅÂùá‰∏∫Ôºönacos

![image-20210127232554083](SpringCloud/image-20210127232554083.png)



> Êû∂ÊûÑ

- Âü∫Á°ÄÊû∂ÊûÑ

![NacosInfrastructure](SpringCloud/NacosInfrastructure.jpeg)

- ÈÄªËæëÊû∂ÊûÑ

![NacosLogicalArchitecture](SpringCloud/NacosLogicalArchitecture.png)

- ÂÖ®ÊôØÊû∂ÊûÑ

![NacosBuildAndDeploy](SpringCloud/NacosBuildAndDeploy.png)



> CAP

nacosÊîØÊåÅCPÂíåAP‰πãÈó¥ÁöÑÂàáÊç¢Ôºö

- Â¶ÇÊûú‰∏çÈúÄË¶ÅÂ≠òÂÇ®ÊúçÂä°Á∫ßÂà´ÁöÑ‰ø°ÊÅØ‰∏îÊúçÂä°ÂÆû‰æãÊòØÈÄöËøánacos-clientÊ≥®ÂÜåÔºåÂπ∂ËÉΩÂ§ü‰øùÊåÅÂøÉË∑≥‰∏äÊä•ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄâÊã©APÊ®°Âºè„ÄÇÂΩìÂâç‰∏ªÊµÅÁöÑÊúçÂä°Â¶ÇSpring CloudÂíåDubboÊúçÂä°ÔºåÈÉΩÈÄÇÁî®‰∫éAPÊ®°ÂºèÔºåAPÊ®°Âºè‰∏∫‰∫ÜÊúçÂä°ÁöÑÂèØËÉΩÊÄßËÄåÂáèÂº±‰∫Ü‰∏ÄËá¥ÊÄßÔºåÂõ†Ê≠§APÊ®°Âºè‰∏ãÂè™ÊîØÊåÅÊ≥®ÂÜå‰∏¥Êó∂ÂÆû‰æã„ÄÇ
- Â¶ÇÊûúÈúÄË¶ÅÂú®ÊúçÂä°Á∫ßÂà´ÁºñËæëÊàñËÄÖÂ≠òÂÇ®ÈÖçÁΩÆ‰ø°ÊÅØÔºåÈÇ£‰πàCPÊòØÂøÖÈ°ªÁöÑ„ÄÇK8SÂíåDNSÊúçÂä°Âô®ÂàôÈÄÇÁî®‰∫éCPÊ®°Âºè„ÄÇCPÊ®°Âºè‰∏ãÊîØÊåÅÊ≥®ÂÜåÊåÅ‰πÖÂåñÂÆû‰æãÔºåÊ≠§Êó∂ÂàôÊòØ‰ª•RaftÂçèËÆÆ‰∏∫ÈõÜÁæ§ËøêË°åÊ®°ÂºèÔºåËØ•Ê®°Âºè‰∏ãÊ≥®ÂÜåÂÆû‰æã‰πãÂâçÂøÖÈ°ªÂÖàÊ≥®ÂÜåÊúçÂä°ÔºåÂ¶ÇÊûúÊúçÂä°‰∏çÂ≠òÂú®ÔºåÂàô‰ºöËøîÂõûÈîôËØØ„ÄÇ



> Âä†ËΩΩÈÖçÁΩÆ

- DataIDÊñπÊ°à

  ÊåáÂÆö`spring.profie.active`ÂíåÈÖçÁΩÆÊñá‰ª∂ÁöÑ`DataID`Êù•‰Ωø‰∏çÂêåÁéØÂ¢É‰∏ãËØªÂèñ‰∏çÂêåÁöÑÈÖçÁΩÆ

- GroupÊñπÊ°à

  ÊåáÂÆö`spring.cloud.nacos.config.group`Êù•ÊåáÂÆö‰∏çÂêåÂàÜÁªÑÁöÑÈÖçÁΩÆ

- NameSpaceÊñπÊ°à

  ÊåáÂÆö`spring.cloud.nacos.config.namespace`Êù•ÊåáÂÆö‰∏çÂêåÂëΩÂêçÁ©∫Èó¥ÁöÑÈÖçÁΩÆ

ÊÄªÁªìÔºåNameSpaceÂåÖÂê´GroupÔºåGroupÂåÖÂê´DataID„ÄÇ



> ÈÉ®ÁΩ≤Ê®°Âºè

NacosÊîØÊåÅ‰∏âÁßçÈÉ®ÁΩ≤Ê®°ÂºèÔºö

- ÂçïÊú∫Ê®°Âºè-Áî®‰∫éÊµãËØïÂíåÂçïÊú∫‰ΩøÁî®
- ÈõÜÁæ§Ê®°Âºè-Áî®‰∫éÁîü‰∫ßÁéØÂ¢ÉÔºåÁ°Æ‰øùÈ´òÂèØÁî®
- Â§öÈõÜÁæ§Ê®°Âºè-Áî®‰∫éÂ§öÊï∞ÊçÆ‰∏≠ÂøÉÂú∫ÊôØ



> ÊåÅ‰πÖÂåñ

ÈªòËÆ§Nacos‰ΩøÁî®ÂµåÂÖ•ÂºèÊï∞ÊçÆÂ∫ìÂÆûÁé∞Êï∞ÊçÆÁöÑÂ≠òÂÇ®„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÂêØÂä®Â§ö‰∏™ÈªòËÆ§ÈÖçÁΩÆ‰∏ãÁöÑNacosËäÇÁÇπÔºåÊï∞ÊçÆÂ≠òÂÇ®ÊòØÂ≠òÂú®‰∏ÄËá¥ÊÄßÈóÆÈ¢òÁöÑ„ÄÇ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåNacosÈááÁî®‰∫ÜÈõÜ‰∏≠ÂºèÂ≠òÂÇ®ÁöÑÊñπÂºèÊù•ÊîØÊåÅÈõÜÁæ§ÂåñÈÉ®ÁΩ≤ÔºåÁõÆÂâçÂè™ÊîØÊåÅMySQLÁöÑÂ≠òÂÇ®„ÄÇ



> ‰ΩøÁî®MySQL

```shell
# ÂàõÂª∫ÈÖçÁΩÆÊñá‰ª∂ÂíåÊó•ÂøóÊñá‰ª∂ÁõÆÂΩï
mkdir -p /opt/nacos/single/init.d /opt/nacos/single/logs 
cd /opt/nacos/single/init.d && touch custom.properties

# custom.propertiesÊñá‰ª∂‰∏≠Â°´ÂÜôÂ¶Ç‰∏ãÈÖçÁΩÆ
server.contextPath=/nacos
server.servlet.contextPath=/nacos
server.port=8848
spring.datasource.platform=mysql

db.num=1
db.url.0=jdbc:mysql://172.17.0.5:3306/nacos_config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true
db.user=root
db.password=KAG1823

nacos.cmdb.dumpTaskInterval=3600
nacos.cmdb.eventTaskInterval=10
nacos.cmdb.labelTaskInterval=300
nacos.cmdb.loadDataAtStart=false

management.metrics.export.elastic.enabled=false
management.metrics.export.influx.enabled=false
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D %{User-Agent}i
nacos.security.ignore.urls=/,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/login,/v1/console/health/**,/v1/cs/**,/v1/ns/**,/v1/cmdb/**,/actuator/**,/v1/console/server/**
nacos.naming.distro.taskDispatchThreadCount=1
nacos.naming.distro.taskDispatchPeriod=200
nacos.naming.distro.batchSyncKeyCount=1000
nacos.naming.distro.initDataRatio=0.9
nacos.naming.distro.syncRetryDelay=5000
nacos.naming.data.warmup=true
nacos.naming.expireInstance=true

# ÂàõÂª∫Âπ∂ÂêØÂä®ÂÆπÂô®
docker run --name nacos -p 8848:8848   \
--privileged=true \
--restart=always \
-e JVM_XMS=256m \
-e JVM_XMX=256m \
-e MODE=standalone \
-e PREFER_HOST_MODE=hostname \
-v /opt/nacos/single/logs:/home/nacos/logs \
-v /opt/nacos/single/init.d/custom.properties:/home/nacos/init.d/custom.properties \
-d nacos/nacos-server:1.3.1
```



> ÈõÜÁæ§

```shell
docker run -d \
-e MODE=cluster \
-e NACOS_APPLICATION_PORT=8849 \
-e NACOS_SERVERS=192.168.117.155:8849,192.168.117.155:8850,192.168.117.155:8851 \
-e SPRING_DATASOURCE_PLATFORM=mysql \
-e MYSQL_SERVICE_HOST=192.168.117.155 \
-e MYSQL_SERVICE_PORT=3306 \
-e MYSQL_SERVICE_USER=root \
-e MYSQL_SERVICE_PASSWORD=KAG1823 \
-e MYSQL_SERVICE_DB_NAME=nacos_config \
-e NACOS_SERVER_IP=192.168.117.155 \
-p 8849:8849 \
--name nacos8849 \
nacos/nacos-server:1.3.1
 
docker run -d \
-e MODE=cluster \
-e NACOS_APPLICATION_PORT=8850 \
-e NACOS_SERVERS=192.168.117.155:8849,192.168.117.155:8850,192.168.117.155:8851 \
-e SPRING_DATASOURCE_PLATFORM=mysql \
-e MYSQL_SERVICE_HOST=192.168.117.155 \
-e MYSQL_SERVICE_PORT=3306 \
-e MYSQL_SERVICE_USER=root \
-e MYSQL_SERVICE_PASSWORD=KAG1823 \
-e MYSQL_SERVICE_DB_NAME=nacos_config \
-e NACOS_SERVER_IP=192.168.100.132 \
-p 8850:8850 \
--name nacos8850 \
nacos/nacos-server:1.3.1
 
docker run -d \
-e MODE=cluster \
-e NACOS_APPLICATION_PORT=8851 \
-e NACOS_SERVERS=192.168.117.155:8849,192.168.117.155:8850,192.168.117.155:8851 \
-e SPRING_DATASOURCE_PLATFORM=mysql \
-e MYSQL_SERVICE_HOST=192.168.117.155 \
-e MYSQL_SERVICE_PORT=3306 \
-e MYSQL_SERVICE_USER=root \
-e MYSQL_SERVICE_PASSWORD=KAG1823 \
-e MYSQL_SERVICE_DB_NAME=nacos_config \
-e NACOS_SERVER_IP=192.168.100.132 \
-p 8851:8851 \
--name nacos8851 \
nacos/nacos-server:1.3.1
```





### üõ°Ô∏è Sentinel



> ÊñáÊ°£

https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B%E7%BB%8D



> Ê¶ÇËø∞

ÈöèÁùÄÂæÆÊúçÂä°ÁöÑÊµÅË°åÔºåÊúçÂä°ÂíåÊúçÂä°‰πãÈó¥ÁöÑÁ®≥ÂÆöÊÄßÂèòÂæóË∂äÊù•Ë∂äÈáçË¶Å„ÄÇSentinel ‰ª•ÊµÅÈáè‰∏∫ÂàáÂÖ•ÁÇπÔºå‰ªéÊµÅÈáèÊéßÂà∂„ÄÅÁÜîÊñ≠ÈôçÁ∫ß„ÄÅÁ≥ªÁªüË¥üËΩΩ‰øùÊä§Á≠âÂ§ö‰∏™Áª¥Â∫¶‰øùÊä§ÊúçÂä°ÁöÑÁ®≥ÂÆöÊÄß„ÄÇ

Sentinel ÂÖ∑Êúâ‰ª•‰∏ãÁâπÂæÅ:

- **‰∏∞ÂØåÁöÑÂ∫îÁî®Âú∫ÊôØ**ÔºöSentinel ÊâøÊé•‰∫ÜÈòøÈáåÂ∑¥Â∑¥Ëøë 10 Âπ¥ÁöÑÂèåÂçÅ‰∏ÄÂ§ß‰øÉÊµÅÈáèÁöÑÊ†∏ÂøÉÂú∫ÊôØÔºå‰æãÂ¶ÇÁßíÊùÄÔºàÂç≥Á™ÅÂèëÊµÅÈáèÊéßÂà∂Âú®Á≥ªÁªüÂÆπÈáèÂèØ‰ª•ÊâøÂèóÁöÑËåÉÂõ¥Ôºâ„ÄÅÊ∂àÊÅØÂâäÂ≥∞Â°´Ë∞∑„ÄÅÈõÜÁæ§ÊµÅÈáèÊéßÂà∂„ÄÅÂÆûÊó∂ÁÜîÊñ≠‰∏ãÊ∏∏‰∏çÂèØÁî®Â∫îÁî®Á≠â„ÄÇ
- **ÂÆåÂ§áÁöÑÂÆûÊó∂ÁõëÊéß**ÔºöSentinel ÂêåÊó∂Êèê‰æõÂÆûÊó∂ÁöÑÁõëÊéßÂäüËÉΩ„ÄÇÊÇ®ÂèØ‰ª•Âú®ÊéßÂà∂Âè∞‰∏≠ÁúãÂà∞Êé•ÂÖ•Â∫îÁî®ÁöÑÂçïÂè∞Êú∫Âô®ÁßíÁ∫ßÊï∞ÊçÆÔºåÁîöËá≥ 500 Âè∞‰ª•‰∏ãËßÑÊ®°ÁöÑÈõÜÁæ§ÁöÑÊ±áÊÄªËøêË°åÊÉÖÂÜµ„ÄÇ
- **ÂπøÊ≥õÁöÑÂºÄÊ∫êÁîüÊÄÅ**ÔºöSentinel Êèê‰æõÂºÄÁÆ±Âç≥Áî®ÁöÑ‰∏éÂÖ∂ÂÆÉÂºÄÊ∫êÊ°ÜÊû∂/Â∫ìÁöÑÊï¥ÂêàÊ®°ÂùóÔºå‰æãÂ¶Ç‰∏é Spring Cloud„ÄÅDubbo„ÄÅgRPC ÁöÑÊï¥Âêà„ÄÇÊÇ®Âè™ÈúÄË¶ÅÂºïÂÖ•Áõ∏Â∫îÁöÑ‰æùËµñÂπ∂ËøõË°åÁÆÄÂçïÁöÑÈÖçÁΩÆÂç≥ÂèØÂø´ÈÄüÂú∞Êé•ÂÖ• Sentinel„ÄÇ
- **ÂÆåÂñÑÁöÑ SPI Êâ©Â±ïÁÇπ**ÔºöSentinel Êèê‰æõÁÆÄÂçïÊòìÁî®„ÄÅÂÆåÂñÑÁöÑ SPI Êâ©Â±ïÊé•Âè£„ÄÇÊÇ®ÂèØ‰ª•ÈÄöËøáÂÆûÁé∞Êâ©Â±ïÊé•Âè£Êù•Âø´ÈÄüÂú∞ÂÆöÂà∂ÈÄªËæë„ÄÇ‰æãÂ¶ÇÂÆöÂà∂ËßÑÂàôÁÆ°ÁêÜ„ÄÅÈÄÇÈÖçÂä®ÊÄÅÊï∞ÊçÆÊ∫êÁ≠â„ÄÇ



> DockerËøêË°åSentinel

```shell
docker pull bladex/sentinel-dashboard
docker run --name sentinel -d -p 8858:8858 -d bladex/sentinel-dashboard
```



> ÊµÅÊéßËßÑÂàô

1Ô∏è‚É£Ëß£ÈáäËØ¥Êòé

- ËµÑÊ∫êÂêçÔºöÂîØ‰∏ÄË∑ØÂæÑÔºåÈªòËÆ§ËØ∑Ê±ÇË∑ØÂæÑ
- ÈíàÂØπÊù•Ê∫êÔºöSentinelÂèØ‰ª•ÈíàÂØπË∞ÉÁî®ËÄÖËøõË°åÈôêÊµÅÔºåÂ°´ÂÜôÂæÆÊúçÂä°ÂêçÔºåÈªòËÆ§default
- ÈòàÂÄºÁ±ªÂûã/ÂçïÊú∫ÈòàÂÄºÔºö
  - QPSÔºàÊØèÁßíÈíüÁöÑËØ∑Ê±ÇÊï∞ÈáèÔºâÔºöÂΩì‰πîÂãáËØ•APIÁöÑQPSËææÂà∞ÈòàÂÄºÁöÑÊó∂ÂÄôÔºåËøõË°åÈôêÊµÅ
  - Á∫øÁ®ãÊï∞ÔºöÂΩìË∞ÉÁî®ËØ•APIÁöÑÁ∫øÁ®ãÊï∞ËææÂà∞ÈòàÂÄºÁöÑÊó∂ÂÄôÔºåËøõË°åÈôêÊµÅ

2Ô∏è‚É£ÊµÅÊéßÊ®°Âºè

- Áõ¥Êé•ÔºöAPIËææÂà∞Á∫øË∑ØÊù°‰ª∂Êó∂ÔºåÁõ¥Êé•ÈôêÊµÅ
- ÂÖ≥ËÅîÔºöÂΩìÂÖ≥ËÅîÁöÑËµÑÊ∫êËææÂà∞ÈòàÂÄºÊó∂ÔºåÂ∞±ÈôêÊµÅËá™Â∑±
- ÈìæË∑ØÔºöÂè™ËÆ∞ÂΩïÊåáÂÆöÈìæË∑Ø‰∏äÁöÑÊµÅÈáèÔºàÊåáÂÆöËµÑÊ∫ê‰ªéÂÖ•Âè£ËµÑÊ∫êËøõÊù•ÁöÑÊµÅÈáèÔºåÂ¶ÇÊûúËææÂà∞ÈòàÂÄºÔºåÂ∞±ËøõË°åÈôêÊµÅÔºâ

3Ô∏è‚É£ÊµÅÊéßÊïàÊûú

- Âø´ÈÄüÂ§±Ë¥•ÔºöÈªòËÆ§ÁöÑÊµÅÈáèÊéßÂà∂ÊñπÂºèÔºåÂΩìQPSË∂ÖËøá‰ªªÊÑèËßÑÂàôÁöÑÈòàÂÄºÂêéÔºåÊñ∞ÁöÑËØ∑Ê±ÇÂ∞±‰ºöË¢´Á´ãÂç≥ÊãíÁªùÔºåÊãíÁªùÊñπÂºè‰∏∫ÊäõÂá∫`FlowException`„ÄÇ [Blocked by Sentinel (flow limiting)]

- Warm Up(È¢ÑÁÉ≠/ÂÜ∑ÂêØÂä®)ÔºöÂΩìÁ≥ªÁªüÈïøÊúüÂ§Ñ‰∫é‰ΩéÊ∞¥‰ΩçÁöÑÊÉÖÂÜµ‰∏ãÔºåÂΩìÊµÅÈáèÁ™ÅÁÑ∂Â¢ûÂä†Êó∂ÔºåÁõ¥Êé•ÊääÁ≥ªÁªüÊãâÂçáÂà∞È´òÊ∞¥‰ΩçÂèØËÉΩÁû¨Èó¥ÊääÁ≥ªÁªüÂéãÂûÆ„ÄÇÈÄöËøá"ÂÜ∑ÂêØÂä®"ÔºåËÆ©ÈÄöËøáÁöÑÊµÅÈáèÁºìÊÖ¢Â¢ûÂä†ÔºåÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÈÄêÊ∏êÂ¢ûÂä†Âà∞ÈòàÂÄº‰∏äÈôêÔºåÁªôÂÜ∑Á≥ªÁªü‰∏Ä‰∏™È¢ÑÁÉ≠ÁöÑÊó∂Èó¥ÔºåÈÅøÂÖçÂÜ∑Á≥ªÁªüË¢´ÂéãÂûÆ„ÄÇ

  [Ê†πÊçÆcodeFactorÔºàÂÜ∑Âä†ËΩΩÂõ†Â≠êÔºåÈªòËÆ§3ÔºâÔºåÁªèËøáÈ¢ÑÁÉ≠Êó∂ÈïøÔºåÊâçËææÂà∞ËÆæÁΩÆÁöÑQPSÈòàÂÄº]

- ÊéíÈòüÁ≠âÂæÖÔºöÂåÄÈÄüÊéíÈòüÊñπÂºè‰ºö‰∏•Ê†ºÊéßÂà∂ËØ∑Ê±ÇÈÄöËøáÁöÑÈó¥ÈöîÊó∂Èó¥Ôºå‰πüÂç≥ÊòØËÆ©ËØ∑Ê±Ç‰ª•ÂùáÂåÄÁöÑÈÄüÂ∫¶ÈÄöËøáÔºåÂØπÂ∫îÁöÑÊòØÊºèÊ°∂ÁÆóÊ≥ï„ÄÇ[ËÆæÁΩÆQPSÊéßÂà∂Èó¥ÈöîÊó∂Èó¥ÔºåÈó¥ÈöîÊó∂Èó¥=1000ms/QPSÔºå‰æãÂ¶ÇQPS=2Êó∂ÊØèÈöî500msÊâçÂÖÅËÆ∏‰∏ã‰∏Ä‰∏™ËØ∑Ê±Ç]



> ÈôçÁ∫ßËßÑÂàô

1Ô∏è‚É£Ëß£ÈáäËØ¥Êòé

SentinelÁÜîÊñ≠ÈôçÁ∫ß‰ºöÂú®Ë∞ÉÁî®ÈìæË∑Ø‰∏≠Êüê‰∏™ËµÑÊ∫êÂá∫Áé∞‰∏çÁ®≥ÂÆöÁä∂ÊÄÅÊó∂Ôºà‰æãÂ¶ÇË∞ÉÁî®Ë∂ÖÊó∂ÊàñÂºÇÂ∏∏ÊØî‰æãÂçáÈ´òÔºâÔºåÂØπËøô‰∏™ËµÑÊ∫êÁöÑË∞ÉÁî®ËøõË°åÈôêÂà∂ÔºåËÆ©ËØ∑Ê±ÇÂø´ÈÄüÂ§±Ë¥•ÔºåÈÅøÂÖçÂΩ±ÂìçÂà∞ÂÖ∂‰ªñÁöÑËµÑÊ∫êËÄåÂØºËá¥Á∫ßËÅîÈîôËØØ„ÄÇ

ÂΩìËµÑÊ∫êÈôçÁ∫ßÂêéÔºåÂú®Êé•‰∏ãÊù•ÁöÑÈôçÁ∫ßÊó∂Èó¥Á™óÂè£ÂÜÖÔºåÂØπËØ•ËµÑÊ∫êÁöÑË∞ÉÁî®ÈÉΩËá™Âä®ÁÜîÊñ≠ÔºàÈªòËÆ§Ë°å‰∏∫ÊòØÊäõÂá∫`DegradeException`Ôºâ„ÄÇ

2Ô∏è‚É£ÁÜîÊñ≠Á≠ñÁï•

Sentinel Êèê‰æõ‰ª•‰∏ãÂá†ÁßçÁÜîÊñ≠Á≠ñÁï•Ôºö

- ÊÖ¢Ë∞ÉÁî®ÊØî‰æã (`SLOW_REQUEST_RATIO`)ÔºöÈÄâÊã©‰ª•ÊÖ¢Ë∞ÉÁî®ÊØî‰æã‰Ωú‰∏∫ÈòàÂÄºÔºåÈúÄË¶ÅËÆæÁΩÆÂÖÅËÆ∏ÁöÑÊÖ¢Ë∞ÉÁî® RTÔºàÂç≥ÊúÄÂ§ßÁöÑÂìçÂ∫îÊó∂Èó¥ÔºâÔºåËØ∑Ê±ÇÁöÑÂìçÂ∫îÊó∂Èó¥Â§ß‰∫éËØ•ÂÄºÂàôÁªüËÆ°‰∏∫ÊÖ¢Ë∞ÉÁî®„ÄÇÂΩìÂçï‰ΩçÁªüËÆ°Êó∂ÈïøÔºà`statIntervalMs`ÔºâÂÜÖËØ∑Ê±ÇÊï∞ÁõÆÂ§ß‰∫éËÆæÁΩÆÁöÑÊúÄÂ∞èËØ∑Ê±ÇÊï∞ÁõÆÔºåÂπ∂‰∏îÊÖ¢Ë∞ÉÁî®ÁöÑÊØî‰æãÂ§ß‰∫éÈòàÂÄºÔºåÂàôÊé•‰∏ãÊù•ÁöÑÁÜîÊñ≠Êó∂ÈïøÂÜÖËØ∑Ê±Ç‰ºöËá™Âä®Ë¢´ÁÜîÊñ≠„ÄÇÁªèËøáÁÜîÊñ≠Êó∂ÈïøÂêéÁÜîÊñ≠Âô®‰ºöËøõÂÖ•Êé¢ÊµãÊÅ¢Â§çÁä∂ÊÄÅÔºàHALF-OPEN Áä∂ÊÄÅÔºâÔºåËã•Êé•‰∏ãÊù•ÁöÑ‰∏Ä‰∏™ËØ∑Ê±ÇÂìçÂ∫îÊó∂Èó¥Â∞è‰∫éËÆæÁΩÆÁöÑÊÖ¢Ë∞ÉÁî® RT ÂàôÁªìÊùüÁÜîÊñ≠ÔºåËã•Â§ß‰∫éËÆæÁΩÆÁöÑÊÖ¢Ë∞ÉÁî® RT Âàô‰ºöÂÜçÊ¨°Ë¢´ÁÜîÊñ≠„ÄÇ
- ÂºÇÂ∏∏ÊØî‰æã (`ERROR_RATIO`)ÔºöÂΩìÂçï‰ΩçÁªüËÆ°Êó∂ÈïøÔºà`statIntervalMs`ÔºâÂÜÖËØ∑Ê±ÇÊï∞ÁõÆÂ§ß‰∫éËÆæÁΩÆÁöÑÊúÄÂ∞èËØ∑Ê±ÇÊï∞ÁõÆÔºåÂπ∂‰∏îÂºÇÂ∏∏ÁöÑÊØî‰æãÂ§ß‰∫éÈòàÂÄºÔºåÂàôÊé•‰∏ãÊù•ÁöÑÁÜîÊñ≠Êó∂ÈïøÂÜÖËØ∑Ê±Ç‰ºöËá™Âä®Ë¢´ÁÜîÊñ≠„ÄÇÁªèËøáÁÜîÊñ≠Êó∂ÈïøÂêéÁÜîÊñ≠Âô®‰ºöËøõÂÖ•Êé¢ÊµãÊÅ¢Â§çÁä∂ÊÄÅÔºàHALF-OPEN Áä∂ÊÄÅÔºâÔºåËã•Êé•‰∏ãÊù•ÁöÑ‰∏Ä‰∏™ËØ∑Ê±ÇÊàêÂäüÂÆåÊàêÔºàÊ≤°ÊúâÈîôËØØÔºâÂàôÁªìÊùüÁÜîÊñ≠ÔºåÂê¶Âàô‰ºöÂÜçÊ¨°Ë¢´ÁÜîÊñ≠„ÄÇÂºÇÂ∏∏ÊØîÁéáÁöÑÈòàÂÄºËåÉÂõ¥ÊòØ `[0.0, 1.0]`Ôºå‰ª£Ë°® 0% - 100%„ÄÇ
- ÂºÇÂ∏∏Êï∞ (`ERROR_COUNT`)ÔºöÂΩìÂçï‰ΩçÁªüËÆ°Êó∂ÈïøÂÜÖÁöÑÂºÇÂ∏∏Êï∞ÁõÆË∂ÖËøáÈòàÂÄº‰πãÂêé‰ºöËá™Âä®ËøõË°åÁÜîÊñ≠„ÄÇÁªèËøáÁÜîÊñ≠Êó∂ÈïøÂêéÁÜîÊñ≠Âô®‰ºöËøõÂÖ•Êé¢ÊµãÊÅ¢Â§çÁä∂ÊÄÅÔºàHALF-OPEN Áä∂ÊÄÅÔºâÔºåËã•Êé•‰∏ãÊù•ÁöÑ‰∏Ä‰∏™ËØ∑Ê±ÇÊàêÂäüÂÆåÊàêÔºàÊ≤°ÊúâÈîôËØØÔºâÂàôÁªìÊùüÁÜîÊñ≠ÔºåÂê¶Âàô‰ºöÂÜçÊ¨°Ë¢´ÁÜîÊñ≠„ÄÇ



> ÁÉ≠ÁÇπËßÑÂàô

1Ô∏è‚É£Ëß£ÈáäËØ¥Êòé

‰Ωï‰∏∫ÁÉ≠ÁÇπÔºüÁÉ≠ÁÇπÂç≥ÁªèÂ∏∏ËÆøÈóÆÁöÑÊï∞ÊçÆ„ÄÇÂæàÂ§öÊó∂ÂÄôÊàë‰ª¨Â∏åÊúõÁªüËÆ°Êüê‰∏™ÁÉ≠ÁÇπÊï∞ÊçÆ‰∏≠ËÆøÈóÆÈ¢ëÊ¨°ÊúÄÈ´òÁöÑ Top K Êï∞ÊçÆÔºåÂπ∂ÂØπÂÖ∂ËÆøÈóÆËøõË°åÈôêÂà∂„ÄÇÊØîÂ¶ÇÔºö

- ÂïÜÂìÅ ID ‰∏∫ÂèÇÊï∞ÔºåÁªüËÆ°‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÊúÄÂ∏∏Ë¥≠‰π∞ÁöÑÂïÜÂìÅ ID Âπ∂ËøõË°åÈôêÂà∂
- Áî®Êà∑ ID ‰∏∫ÂèÇÊï∞ÔºåÈíàÂØπ‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÈ¢ëÁπÅËÆøÈóÆÁöÑÁî®Êà∑ ID ËøõË°åÈôêÂà∂

ÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅ‰ºöÁªüËÆ°‰º†ÂÖ•ÂèÇÊï∞‰∏≠ÁöÑÁÉ≠ÁÇπÂèÇÊï∞ÔºåÂπ∂Ê†πÊçÆÈÖçÁΩÆÁöÑÈôêÊµÅÈòàÂÄº‰∏éÊ®°ÂºèÔºåÂØπÂåÖÂê´ÁÉ≠ÁÇπÂèÇÊï∞ÁöÑËµÑÊ∫êË∞ÉÁî®ËøõË°åÈôêÊµÅ„ÄÇÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅÂèØ‰ª•ÁúãÂÅöÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊµÅÈáèÊéßÂà∂Ôºå‰ªÖÂØπÂåÖÂê´ÁÉ≠ÁÇπÂèÇÊï∞ÁöÑËµÑÊ∫êË∞ÉÁî®ÁîüÊïà„ÄÇ

Sentinel Âà©Áî® LRU Á≠ñÁï•ÁªüËÆ°ÊúÄËøëÊúÄÂ∏∏ËÆøÈóÆÁöÑÁÉ≠ÁÇπÂèÇÊï∞ÔºåÁªìÂêà‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÊù•ËøõË°åÂèÇÊï∞Á∫ßÂà´ÁöÑÊµÅÊéß„ÄÇÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅÊîØÊåÅÈõÜÁæ§Ê®°Âºè„ÄÇ

2Ô∏è‚É£ÂèÇÊï∞ËØ¶ÊÉÖ

ÁÉ≠ÁÇπÂèÇÊï∞ËßÑÂàôÔºà`ParamFlowRule`ÔºâÁ±ª‰ºº‰∫éÊµÅÈáèÊéßÂà∂ËßÑÂàôÔºà`FlowRule`ÔºâÔºö

| Â±ûÊÄß              | ËØ¥Êòé                                                         | ÈªòËÆ§ÂÄº   |
| ----------------- | ------------------------------------------------------------ | -------- |
| resource          | ËµÑÊ∫êÂêçÔºåÂøÖÂ°´                                                 |          |
| count             | ÈôêÊµÅÈòàÂÄºÔºåÂøÖÂ°´                                               |          |
| grade             | ÈôêÊµÅÊ®°Âºè                                                     | QPS Ê®°Âºè |
| durationInSec     | ÁªüËÆ°Á™óÂè£Êó∂Èó¥ÈïøÂ∫¶ÔºàÂçï‰Ωç‰∏∫ÁßíÔºâÔºå1.6.0 ÁâàÊú¨ÂºÄÂßãÊîØÊåÅ             | 1s       |
| controlBehavior   | ÊµÅÊéßÊïàÊûúÔºàÊîØÊåÅÂø´ÈÄüÂ§±Ë¥•ÂíåÂåÄÈÄüÊéíÈòüÊ®°ÂºèÔºâÔºå1.6.0 ÁâàÊú¨ÂºÄÂßãÊîØÊåÅ   | Âø´ÈÄüÂ§±Ë¥• |
| maxQueueingTimeMs | ÊúÄÂ§ßÊéíÈòüÁ≠âÂæÖÊó∂ÈïøÔºà‰ªÖÂú®ÂåÄÈÄüÊéíÈòüÊ®°ÂºèÁîüÊïàÔºâÔºå1.6.0 ÁâàÊú¨ÂºÄÂßãÊîØÊåÅ | 0ms      |
| paramIdx          | ÁÉ≠ÁÇπÂèÇÊï∞ÁöÑÁ¥¢ÂºïÔºåÂøÖÂ°´ÔºåÂØπÂ∫î `SphU.entry(xxx, args)` ‰∏≠ÁöÑÂèÇÊï∞Á¥¢Âºï‰ΩçÁΩÆ |          |
| paramFlowItemList | ÂèÇÊï∞‰æãÂ§ñÈ°πÔºåÂèØ‰ª•ÈíàÂØπÊåáÂÆöÁöÑÂèÇÊï∞ÂÄºÂçïÁã¨ËÆæÁΩÆÈôêÊµÅÈòàÂÄºÔºå‰∏çÂèóÂâçÈù¢ `count` ÈòàÂÄºÁöÑÈôêÂà∂„ÄÇ**‰ªÖÊîØÊåÅÂü∫Êú¨Á±ªÂûãÂíåÂ≠óÁ¨¶‰∏≤Á±ªÂûã** |          |
| clusterMode       | ÊòØÂê¶ÊòØÈõÜÁæ§ÂèÇÊï∞ÊµÅÊéßËßÑÂàô                                       | `false`  |
| clusterConfig     | ÈõÜÁæ§ÊµÅÊéßÁõ∏ÂÖ≥ÈÖçÁΩÆ                                             |          |



### üåå Seata



> Ê¶ÇËø∞

Seata ÊòØ‰∏ÄÊ¨æÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°àÔºåËá¥Âäõ‰∫éÊèê‰æõÈ´òÊÄßËÉΩÂíåÁÆÄÂçïÊòìÁî®ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊúçÂä°„ÄÇSeata Â∞Ü‰∏∫Áî®Êà∑Êèê‰æõ‰∫Ü AT„ÄÅTCC„ÄÅSAGA Âíå XA ‰∫ãÂä°Ê®°ÂºèÔºå‰∏∫Áî®Êà∑ÊâìÈÄ†‰∏ÄÁ´ôÂºèÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°à„ÄÇ



> Seata.zip‰∏ãËΩΩ

**0.9.0**

- ÁôæÂ∫¶ÁΩëÁõòÔºöhttps://pan.baidu.com/s/1SYGqlJEpashJlR-Nc8H8lg
- ÊèêÂèñÁ†ÅÔºökkkk

**1.4.0**

- ÁôæÂ∫¶ÁΩëÁõòÔºöhttps://pan.baidu.com/s/1fpzo0zkfLFa8sJDs-TL9Ew
- ÊèêÂèñÁ†ÅÔºökkkk



> DockerÂÆâË£ÖSeata

```shell
# Ëé∑ÂèñÈïúÂÉè
$ docker pull seataio/seata-server:1.4.0
# ËøêË°åÂÆπÂô®Âπ∂Ëé∑ÂèñÈÖçÁΩÆ
$ docker run --name seata-server -p 8091:8091 -d seataio/seata-server:1.4.0
$ docker cp seata-server:/seata-server /usr/local/seata-1.4.0
$ docker stop seata-server && docker rm seata-server
# ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂
# file.conf
service {
  vgroupMapping.my_test_tx_group = "default"
  disableGlobalTransaction = false
}

store {
  mode = "db"
  db {
    datasource = "druid"
    dbType = "mysql"
    driverClassName = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://172.17.0.5:3306/seata?serverTimezone=GMT%2B8&useUnicode=true&characterEncoding=utf-8&useSSL=false"
    user = "root"
    password = "KAG1823"
    minConn = 5
    maxConn = 30
    globalTable = "global_table"
    branchTable = "branch_table"
    lockTable = "lock_table"
    queryLimit = 100
    maxWait = 5000
  }
}

# registry.conf
registry {
  type = "nacos"
  loadBalance = "RandomLoadBalance"
  loadBalanceVirtualNodes = 10

  nacos {
    application = "seata-server"
    serverAddr = "172.17.0.6:8848"
    group = "SEATA_GROUP"
    namespace = ""
    cluster = "default"
    username = "nacos"
    password = "nacos"
  }
}

config {
  type = "nacos"

  nacos {
    serverAddr = "172.17.0.6:8848"
    namespace = ""
    group = "SEATA_GROUP"
    username = "nacos"
    password = "nacos"
  }
}

# ÂêØÂä®Seata
$ docker run -d \
--restart always \
--name seata-server \
-p 8091:8091 \
-v /usr/local/seata-1.4.0:/seata-server \
-e SEATA_PORT=8091 \
seataio/seata-server:1.4.0
```


